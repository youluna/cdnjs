"use strict";import H from"../parts/Globals.js";import U from"../parts/Utilities.js";var correctFloat=U.correctFloat,merge=U.merge,seriesType=U.seriesType;import multipleLinesMixin from"../mixins/multipe-lines.js";var SMA=H.seriesTypes.sma,EMA=H.seriesTypes.ema,ATR=H.seriesTypes.atr;seriesType("keltnerchannels","sma",{params:{period:20,periodATR:10,multiplierATR:2},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1,lineColor:void 0}},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span><b> {series.name}</b><br/>Upper Channel: {point.top}<br/>EMA({series.options.params.period}): {point.middle}<br/>Lower Channel: {point.bottom}<br/>'},marker:{enabled:!1},dataGrouping:{approximation:"averages"},lineWidth:1},merge(multipleLinesMixin,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameBase:"Keltner Channels",nameComponents:["period","periodATR","multiplierATR"],linesApiNames:["topLine","bottomLine"],requiredIndicators:["ema","atr"],init:function(){SMA.prototype.init.apply(this,arguments),this.options=merge({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)},getValues:function(e,i){var t,o,r,s,p,n,l,a=i.period,m=i.periodATR,d=i.multiplierATR,u=i.index,y=e.yData,c=y?y.length:0,h=[],A=EMA.prototype.getValues(e,{period:a,index:u}),T=ATR.prototype.getValues(e,{period:m}),b=[],g=[];if(!(c<a)){for(l=a;l<=c;l++)p=A.values[l-a],n=T.values[l-m],s=p[0],o=correctFloat(p[1]+d*n[1]),r=correctFloat(p[1]-d*n[1]),t=p[1],h.push([s,o,t,r]),b.push(s),g.push([o,t,r]);return{values:h,xData:b,yData:g}}}}));