"use strict";import H from"../../parts/Globals.js";import"../../parts/Series.js";import GLRenderer from"./wgl-renderer.js";import U from"../../parts/Utilities.js";var error=U.error,win=H.win,doc=win.document,mainCanvas=doc.createElement("canvas");function createAndAttachRenderer(e,r){var t=e.chartWidth,o=e.chartHeight,a=e,n=e.seriesGroup||r.group;doc.implementation.hasFeature("www.http://w3.org/TR/SVG11/feature#Extensibility","1.1");return!1,(a=e.isChartSeriesBoosting()?e:r).renderTarget||(a.canvas=mainCanvas,e.renderer.forExport,a.renderTarget=e.renderer.image("",0,0,t,o).addClass("highcharts-boost-canvas").add(n),a.boostClear=function(){a.renderTarget.attr({href:""})},a.boostCopy=function(){a.boostResizeTarget(),a.renderTarget.attr({href:a.canvas.toDataURL("image/png")})},a.boostResizeTarget=function(){t=e.chartWidth,o=e.chartHeight,(a.renderTargetFo||a.renderTarget).attr({x:0,y:0,width:t,height:o}).css({pointerEvents:"none",mixedBlendMode:"normal",opacity:1}),a instanceof H.Chart&&a.markerGroup.translate(e.plotLeft,e.plotTop)},a.boostClipRect=e.renderer.clipRect(),(a.renderTargetFo||a.renderTarget).clip(a.boostClipRect),a instanceof H.Chart&&(a.markerGroup=a.renderer.g().add(n),a.markerGroup.translate(r.xAxis.pos,r.yAxis.pos))),a.canvas.width=t,a.canvas.height=o,a.boostClipRect.attr(e.getBoostClipRect(a)),a.boostResizeTarget(),a.boostClear(),a.ogl||(a.ogl=GLRenderer(function(){a.ogl.settings.debug.timeBufferCopy&&console.time("buffer copy"),a.boostCopy(),a.ogl.settings.debug.timeBufferCopy&&console.timeEnd("buffer copy")}),a.ogl.init(a.canvas)||error("[highcharts boost] - unable to init WebGL renderer"),a.ogl.setOptions(e.options.boost||{}),a instanceof H.Chart&&a.ogl.allocateBuffer(e)),a.ogl.setSize(t,o),a.ogl}export default createAndAttachRenderer;