!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return n(o),n.Highcharts=o,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){function n(o,n,t,e){o.hasOwnProperty(n)||(o[n]=e.apply(null,t))}n(o=o?o._modules:{},"indicators/ichimoku-kinko-hyo.src.js",[o["parts/Globals.js"],o["parts/Utilities.js"]],function(i,o){function m(o){return{high:o.reduce(function(o,n){return Math.max(o,n[1])},-1/0),low:o.reduce(function(o,n){return Math.min(o,n[2])},1/0)}}function A(o,n,t,e){if(o&&n&&t&&e){var i=n.plotX-o.plotX;n=n.plotY-o.plotY;var a=e.plotX-t.plotX;e=e.plotY-t.plotY;var p=o.plotX-t.plotX,l=o.plotY-t.plotY;if(t=(-n*p+i*l)/(-a*n+i*e),a=(a*l-e*p)/(-a*n+i*e),0<=t&&t<=1&&0<=a&&a<=1)return{plotX:o.plotX+a*i,plotY:o.plotY+a*n}}return!1}function x(o){var n=o.indicator;n.points=o.points,n.nextPoints=o.nextPoints,n.color=o.color,n.options=N(o.options.senkouSpan.styles,o.gap),n.graph=o.graph,n.fillGraph=!0,b.prototype.drawGraph.call(n)}var Y,C=o.defined,P=o.isArray,B=o.objectEach;o=i.seriesType;var N=i.merge,n=i.color,b=i.seriesTypes.sma;o("ikh","sma",{params:{period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!(i.approximations["ichimoku-averages"]=function(){var t,e=[];return[].forEach.call(arguments,function(o,n){e.push(i.approximations.average(o)),t=!t&&void 0===e[n]}),t?void 0:e})},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}},{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"],init:function(){b.prototype.init.apply(this,arguments),this.options=N({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:n(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:n(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:n(this.color).setOpacity(.2).get()}}},this.options)},toYData:function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},translate:function(){var t=this;b.prototype.translate.apply(t),t.points.forEach(function(n){t.pointArrayMap.forEach(function(o){C(n[o])&&(n["plot"+o]=t.yAxis.toPixels(n[o],!0),n.plotY=n["plot"+o],n.tooltipPos=[n.plotX,n["plot"+o]],n.isNull=!1)})})},drawGraph:function(){var o,t,n,e=this,i=e.points,a=i.length,p=e.options,l=e.graph,r=e.color,s={options:{gapSize:p.gapSize}},h=e.pointArrayMap.length,u=[[],[],[],[],[],[]],c={tenkanLine:u[0],kijunLine:u[1],chikouLine:u[2],senkouSpanA:u[3],senkouSpanB:u[4],senkouSpan:u[5]},f=[],k=e.options.senkouSpan,g=k.color||k.styles.fill,S=k.negativeColor,d=[[],[]],y=[[],[]],v=0;for(e.ikhMap=c;a--;){var m=i[a];for(o=0;o<h;o++)k=e.pointArrayMap[o],C(m[k])&&u[o].push({plotX:m.plotX,plotY:m["plot"+k],isNull:!1});S&&a!==i.length-1&&(k=c.senkouSpanB.length-1,o={plotX:(m=A(c.senkouSpanA[k-1],c.senkouSpanA[k],c.senkouSpanB[k-1],c.senkouSpanB[k])).plotX,plotY:m.plotY,isNull:!1,intersectPoint:!0},m&&(c.senkouSpanA.splice(k,0,o),c.senkouSpanB.splice(k,0,o),f.push(k)))}if(B(c,function(o,n){p[n]&&"senkouSpan"!==n&&(e.points=u[v],e.options=N(p[n].styles,s),e.graph=e["graph"+n],e.fillGraph=!1,e.color=r,b.prototype.drawGraph.call(e),e["graph"+n]=e.graph),v++}),e.graphCollection&&e.graphCollection.forEach(function(o){e[o].destroy(),delete e[o]}),e.graphCollection=[],S&&c.senkouSpanA[0]&&c.senkouSpanB[0]){for(f.unshift(0),f.push(c.senkouSpanA.length-1),h=0;h<f.length-1;h++){if(k=f[h],m=f[h+1],a=c.senkouSpanB.slice(k,m+1),k=c.senkouSpanA.slice(k,m+1),1<=Math.floor(a.length/2))if(a[m=Math.floor(a.length/2)].plotY===k[m].plotY){for(n=o=m=0;n<a.length;n++)m+=a[n].plotY,o+=k[n].plotY;m=o<m?0:1}else m=a[m].plotY>k[m].plotY?0:1;else m=a[0].plotY>k[0].plotY?0:1;d[m]=d[m].concat(a),y[m]=y[m].concat(k)}["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,n){d[n].length&&y[n].length&&(t=0===n?g:S,x({indicator:e,points:d[n],nextPoints:y[n],color:t,options:p,gap:s,graph:e[o]}),e[o]=e.graph,e.graphCollection.push(o))})}else x({indicator:e,points:c.senkouSpanB,nextPoints:c.senkouSpanA,color:g,options:p,gap:s,graph:e.graphsenkouSpan}),e.graphsenkouSpan=e.graph;delete e.nextPoints,delete e.fillGraph,e.points=i,e.options=p,e.graph=l},getGraphPath:function(o){var n=[];if(o=o||this.points,this.fillGraph&&this.nextPoints){var t=b.prototype.getGraphPath.call(this,this.nextPoints);t[0]="L";for(var e=b.prototype.getGraphPath.call(this,o),i=(t=t.slice(0,e.length)).length-1;0<i;i-=3)n.push(t[i-2],t[i-1],t[i]);e=e.concat(n)}else e=b.prototype.getGraphPath.apply(this,arguments);return e},getValues:function(o,n){var t=n.period,e=n.periodTenkan;n=n.periodSenkouSpanB;var i,a,p,l,r=o.xData,s=o.yData,h=s&&s.length||0;o.xAxis.series.forEach(function(o){if(o.xData)for(p=o.xData,l=o.xIncrement?1:p.length-1;0<l;l--)a=p[l]-p[l-1],(i===Y||a<i)&&(i=a)}),o=i;var u,c=[],f=[];if(!(r.length<=t)&&P(s[0])&&4===s[0].length){var k=r[0]-t*o;for(u=0;u<t;u++)f.push(k+u*o);for(u=0;u<h;u++){if(e<=u){var g=s.slice(u-e,u);g=((g=m(g)).high+g.low)/2}if(t<=u)var S=s.slice(u-t,u),d=(g+(S=((S=m(S)).high+S.low)/2))/2;if(n<=u){var y=s.slice(u-n,u);y=((y=m(y)).high+y.low)/2}k=s[u][3];var v=r[u];c[u]===Y&&(c[u]=[]),c[u+t]===Y&&(c[u+t]=[]),c[u+t][0]=g,c[u+t][1]=S,c[u+t][2]=Y,c[u][2]=k,u<=t&&(c[u+t][3]=Y,c[u+t][4]=Y),c[u+2*t]===Y&&(c[u+2*t]=[]),c[u+2*t][3]=d,c[u+2*t][4]=y,f.push(v)}for(u=1;u<=t;u++)f.push(v+u*o);return{values:c,xData:f,yData:c}}}})}),n(o,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});