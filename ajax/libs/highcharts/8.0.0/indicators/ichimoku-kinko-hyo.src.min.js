"use strict";!function(n){"object"==typeof module&&module.exports?module.exports=n.default=n:"function"==typeof define&&define.amd?define("highcharts/indicators/ichimoku-kinko-hyo",["highcharts","highcharts/modules/stock"],function(o){return n(o),n.Highcharts=o,n}):n("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(o){var n=o?o._modules:{};function t(o,n,t,e){o.hasOwnProperty(n)||(o[n]=e.apply(null,t))}t(n,"indicators/ichimoku-kinko-hyo.src.js",[n["parts/Globals.js"],n["parts/Utilities.js"]],function(i,o){var b,M=o.defined,G=o.isArray,w=o.objectEach,n=i.seriesType,D=i.merge,t=i.color,O=i.seriesTypes.sma;function X(o){return{high:o.reduce(function(o,n){return Math.max(o,n[1])},-1/0),low:o.reduce(function(o,n){return Math.min(o,n[2])},1/0)}}function K(o,n,t,e){if(o&&n&&t&&e){var i,p,a=n.plotX-o.plotX,l=n.plotY-o.plotY,s=e.plotX-t.plotX,r=e.plotY-t.plotY,h=o.plotX-t.plotX,u=o.plotY-t.plotY;if(p=(s*u-r*h)/(-s*l+a*r),0<=(i=(-l*h+a*u)/(-s*l+a*r))&&i<=1&&0<=p&&p<=1)return{plotX:o.plotX+p*a,plotY:o.plotY+p*l}}return!1}function T(o){var n=o.indicator;n.points=o.points,n.nextPoints=o.nextPoints,n.color=o.color,n.options=D(o.options.senkouSpan.styles,o.gap),n.graph=o.graph,n.fillGraph=!0,O.prototype.drawGraph.call(n)}n("ikh","sma",{params:{period:26,periodTenkan:9,periodSenkouSpanB:52},marker:{enabled:!(i.approximations["ichimoku-averages"]=function(){var t,e=[];return[].forEach.call(arguments,function(o,n){e.push(i.approximations.average(o)),t=!t&&void 0===e[n]}),t?void 0:e})},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span> <b> {series.name}</b><br/>TENKAN SEN: {point.tenkanSen:.3f}<br/>KIJUN SEN: {point.kijunSen:.3f}<br/>CHIKOU SPAN: {point.chikouSpan:.3f}<br/>SENKOU SPAN A: {point.senkouSpanA:.3f}<br/>SENKOU SPAN B: {point.senkouSpanB:.3f}<br/>'},tenkanLine:{styles:{lineWidth:1,lineColor:void 0}},kijunLine:{styles:{lineWidth:1,lineColor:void 0}},chikouLine:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanA:{styles:{lineWidth:1,lineColor:void 0}},senkouSpanB:{styles:{lineWidth:1,lineColor:void 0}},senkouSpan:{styles:{fill:"rgba(255, 0, 0, 0.5)"}},dataGrouping:{approximation:"ichimoku-averages"}},{pointArrayMap:["tenkanSen","kijunSen","chikouSpan","senkouSpanA","senkouSpanB"],pointValKey:"tenkanSen",nameComponents:["periodSenkouSpanB","period","periodTenkan"],init:function(){O.prototype.init.apply(this,arguments),this.options=D({tenkanLine:{styles:{lineColor:this.color}},kijunLine:{styles:{lineColor:this.color}},chikouLine:{styles:{lineColor:this.color}},senkouSpanA:{styles:{lineColor:this.color,fill:t(this.color).setOpacity(.5).get()}},senkouSpanB:{styles:{lineColor:this.color,fill:t(this.color).setOpacity(.5).get()}},senkouSpan:{styles:{fill:t(this.color).setOpacity(.2).get()}}},this.options)},toYData:function(o){return[o.tenkanSen,o.kijunSen,o.chikouSpan,o.senkouSpanA,o.senkouSpanB]},translate:function(){var t=this;O.prototype.translate.apply(t),t.points.forEach(function(n){t.pointArrayMap.forEach(function(o){M(n[o])&&(n["plot"+o]=t.yAxis.toPixels(n[o],!0),n.plotY=n["plot"+o],n.tooltipPos=[n.plotX,n["plot"+o]],n.isNull=!1)})})},drawGraph:function(){var o,n,t,e,i,p,a,l,s,r,h,u,c,f=this,k=f.points,g=k.length,S=f.options,d=f.graph,y=f.color,m={options:{gapSize:S.gapSize}},v=f.pointArrayMap.length,A=[[],[],[],[],[],[]],x={tenkanLine:A[0],kijunLine:A[1],chikouLine:A[2],senkouSpanA:A[3],senkouSpanB:A[4],senkouSpan:A[5]},Y=[],C=f.options.senkouSpan,P=C.color||C.styles.fill,B=C.negativeColor,N=[[],[]],b=[[],[]],G=0;for(f.ikhMap=x;g--;){for(n=k[g],t=0;t<v;t++)o=f.pointArrayMap[t],M(n[o])&&A[t].push({plotX:n.plotX,plotY:n["plot"+o],isNull:!1});if(B&&g!==k.length-1){var X=x.senkouSpanB.length-1,j=K(x.senkouSpanA[X-1],x.senkouSpanA[X],x.senkouSpanB[X-1],x.senkouSpanB[X]),E={plotX:j.plotX,plotY:j.plotY,isNull:!1,intersectPoint:!0};j&&(x.senkouSpanA.splice(X,0,E),x.senkouSpanB.splice(X,0,E),Y.push(X))}}if(w(x,function(o,n){S[n]&&"senkouSpan"!==n&&(f.points=A[G],f.options=D(S[n].styles,m),f.graph=f["graph"+n],f.fillGraph=!1,f.color=y,O.prototype.drawGraph.call(f),f["graph"+n]=f.graph),G++}),f.graphCollection&&f.graphCollection.forEach(function(o){f[o].destroy(),delete f[o]}),f.graphCollection=[],B&&x.senkouSpanA[0]&&x.senkouSpanB[0]){for(Y.unshift(0),Y.push(x.senkouSpanA.length-1),u=0;u<Y.length-1;u++)if(e=Y[u],i=Y[u+1],p=x.senkouSpanB.slice(e,i+1),a=x.senkouSpanA.slice(e,i+1),1<=Math.floor(p.length/2)){var L=Math.floor(p.length/2);if(p[L].plotY===a[L].plotY){for(c=s=l=0;c<p.length;c++)l+=p[c].plotY,s+=a[c].plotY;N[h=s<l?0:1]=N[h].concat(p),b[h]=b[h].concat(a)}else h=p[L].plotY>a[L].plotY?0:1,N[h]=N[h].concat(p),b[h]=b[h].concat(a)}else h=p[0].plotY>a[0].plotY?0:1,N[h]=N[h].concat(p),b[h]=b[h].concat(a);["graphsenkouSpanColor","graphsenkouSpanNegativeColor"].forEach(function(o,n){N[n].length&&b[n].length&&(r=0===n?P:B,T({indicator:f,points:N[n],nextPoints:b[n],color:r,options:S,gap:m,graph:f[o]}),f[o]=f.graph,f.graphCollection.push(o))})}else T({indicator:f,points:x.senkouSpanB,nextPoints:x.senkouSpanA,color:P,options:S,gap:m,graph:f.graphsenkouSpan}),f.graphsenkouSpan=f.graph;delete f.nextPoints,delete f.fillGraph,f.points=k,f.options=S,f.graph=d},getGraphPath:function(o){var n,t=this,e=[],i=[],p=[];if(o=o||this.points,t.fillGraph&&t.nextPoints){(n=O.prototype.getGraphPath.call(t,t.nextPoints))[0]="L",e=O.prototype.getGraphPath.call(t,o);for(var a=(p=n.slice(0,e.length)).length-1;0<a;a-=3)i.push(p[a-2],p[a-1],p[a]);e=e.concat(i)}else e=O.prototype.getGraphPath.apply(t,arguments);return e},getValues:function(o,n){var t,e,i,p,a,l,s,r,h,u,c,f,k,g,S,d,y=n.period,m=n.periodTenkan,v=n.periodSenkouSpanB,A=o.xData,x=o.yData,Y=o.xAxis,C=x&&x.length||0,P=(Y.series.forEach(function(o){if(o.xData)for(S=o.xData,k=o.xIncrement?1:S.length-1,d=k;0<d;d--)g=S[d]-S[d-1],(f===b||g<f)&&(f=g)}),f),B=[],N=[];if(!(A.length<=y)&&G(x[0])&&4===x[0].length){for(t=A[0]-y*P,l=0;l<y;l++)N.push(t+l*P);for(l=0;l<C;l++)m<=l&&(s=((i=X(x.slice(l-m,l))).high+i.low)/2),y<=l&&(u=(s+(r=((p=X(x.slice(l-y,l))).high+p.low)/2))/2),v<=l&&(c=((a=X(x.slice(l-v,l))).high+a.low)/2),h=x[l][3],e=A[l],B[l]===b&&(B[l]=[]),B[l+y]===b&&(B[l+y]=[]),B[l+y][0]=s,B[l+y][1]=r,B[l+y][2]=b,B[l][2]=h,l<=y&&(B[l+y][3]=b,B[l+y][4]=b),B[l+2*y]===b&&(B[l+2*y]=[]),B[l+2*y][3]=u,B[l+2*y][4]=c,N.push(e);for(l=1;l<=y;l++)N.push(e+l*P);return{values:B,xData:N,yData:B}}}})}),t(n,"masters/indicators/ichimoku-kinko-hyo.src.js",[],function(){})});