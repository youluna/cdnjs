!function(e){"object"==typeof module&&module.exports?module.exports=e.default=e:"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(t){return e(t),e.Highcharts=t,e}):e("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){function e(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a))}e(t=t?t._modules:{},"mixins/ajax.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(o,t){var n=t.objectEach;o.ajax=function(t){var e=o.merge(!0,{url:!1,type:"get",dataType:"json",success:!1,error:!1,data:!1,headers:{}},t);t={json:"application/json",xml:"application/xml",text:"text/plain",octet:"application/octet-stream"};var a=new XMLHttpRequest;if(!e.url)return!1;a.open(e.type.toUpperCase(),e.url,!0),e.headers["Content-Type"]||a.setRequestHeader("Content-Type",t[e.dataType]||t.text),n(e.headers,function(t,e){a.setRequestHeader(e,t)}),a.onreadystatechange=function(){if(4===a.readyState){if(200===a.status){var t=a.responseText;if("json"===e.dataType)try{t=JSON.parse(t)}catch(t){return void(e.error&&e.error(a,t))}return e.success&&e.success(t)}e.error&&e.error(a,a.responseText)}};try{e.data=JSON.stringify(e.data)}catch(t){}a.send(e.data||!0)},o.getJSON=function(t,e){o.ajax({url:t,success:e,dataType:"json",headers:{"Content-Type":"text/plain"}})}}),e(t,"mixins/download-url.js",[t["parts/Globals.js"]],function(n){var r=n.win,i=r.navigator,s=r.document,l=r.URL||r.webkitURL||r,c=/Edge\/\d+/.test(i.userAgent);n.dataURLtoBlob=function(t){if((t=t.match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<t.length&&r.atob&&r.ArrayBuffer&&r.Uint8Array&&r.Blob&&l.createObjectURL){var e=r.atob(t[3]),a=new r.ArrayBuffer(e.length);a=new r.Uint8Array(a);for(var o=0;o<a.length;++o)a[o]=e.charCodeAt(o);return t=new r.Blob([a],{type:t[1]}),l.createObjectURL(t)}},n.downloadURL=function(e,t){var a=s.createElement("a");if("string"==typeof e||e instanceof String||!i.msSaveOrOpenBlob){if((c||2e6<e.length)&&!(e=n.dataURLtoBlob(e)))throw Error("Failed to convert to blob");if(void 0!==a.download)a.href=e,a.download=t,s.body.appendChild(a),a.click(),s.body.removeChild(a);else try{var o=r.open(e,"chart");if(null==o)throw Error("Failed to open window")}catch(t){r.location.href=e}}else i.msSaveOrOpenBlob(e,t)}}),e(t,"modules/export-data.src.js",[t["parts/Globals.js"],t["parts/Utilities.js"]],function(C,t){function e(t,e){var a=i.navigator,o=-1<a.userAgent.indexOf("WebKit")&&a.userAgent.indexOf("Chrome")<0,n=i.URL||i.webkitURL||i;try{if(a.msSaveOrOpenBlob&&i.MSBlobBuilder){var r=new i.MSBlobBuilder;return r.append(t),r.getBlob("image/svg+xml")}if(!o)return n.createObjectURL(new i.Blob(["\ufeff"+t],{type:e}))}catch(t){}}var c=t.defined,a=t.extend,o=t.isObject,T=t.pick,i=C.win,n=i.document,r=C.seriesTypes,s=C.downloadURL,d=C.fireEvent;C.setOptions({exporting:{csv:{columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",openInCloud:"Open in Highcharts Cloud",viewData:"View data table"}}),C.addEvent(C.Chart,"render",function(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}),C.Chart.prototype.setUpKeyToAxis=function(){r.arearange&&(r.arearange.prototype.keyToAxis={low:"y",high:"y"}),r.gantt&&(r.gantt.prototype.keyToAxis={start:"x",end:"x"})},C.Chart.prototype.getDataRows=function(h){function t(t,e,a){if(x.columnHeaderFormatter){var o=x.columnHeaderFormatter(t,e,a);if(!1!==o)return o}return t?t instanceof C.Axis?t.options.title&&t.options.title.text||(t.isDatetimeAxis?"DateTime":"Category"):h?{columnTitle:1<a?e:t.name,topLevelColumnTitle:t.name}:t.name+(1<a?" ("+e+")":""):"Category"}function u(a,t,o){var n={},r={};return t.forEach(function(t){var e=(a.keyToAxis&&a.keyToAxis[t]||t)+"Axis";e=C.isNumber(o)?a.chart[e][o]:a[e],n[t]=e&&e.categories||[],r[t]=e&&e.isDatetimeAxis}),{categoryMap:n,dateTimeValueAxisMap:r}}var e,f=this.hasParallelCoordinates,m=this.time,x=this.options.exporting&&this.options.exporting.csv||{},a=this.xAxis,g={},o=[],y=[],b=[],v=[],w=0;for(n in this.setUpKeyToAxis(),this.series.forEach(function(n){var r,i=n.options.keys||n.pointArrayMap||["y"],s=i.length,l=!n.requireSorting&&{},c=a.indexOf(n.xAxis),p=u(n,i);if(!1!==n.options.includeInDataExport&&!n.options.isInternal&&!1!==n.visible){for(C.find(v,function(t){return t[0]===c})||v.push([c,w]),r=0;r<s;)e=t(n,i[r],i.length),b.push(e.columnTitle||e),h&&y.push(e.topLevelColumnTitle||e),r++;var d={chart:n.chart,autoIncrement:n.autoIncrement,options:n.options,pointArrayMap:n.pointArrayMap};n.options.data.forEach(function(t,e){f&&(p=u(n,i,e));var a={series:d};n.pointClass.prototype.applyOptions.apply(a,[t]),t=a.x;var o=n.data[e]&&n.data[e].name;for(r=0,n.xAxis&&"name"!==n.exportKey||(t=o),l&&(l[t]&&(t+="|"+e),l[t]=!0),g[t]||(g[t]=[],g[t].xValues=[]),g[t].x=a.x,g[t].name=o,g[t].xValues[c]=a.x;r<s;)o=a[e=i[r]],g[t][w+r]=T(p.categoryMap[e][o],p.dateTimeValueAxisMap[e]?m.dateFormat(x.dateFormat,o):null,o),r++}),w+=r}}),g)Object.hasOwnProperty.call(g,n)&&o.push(g[n]);var n=h?[y,b]:[b];for(w=v.length;w--;){var r=v[w][0],i=v[w][1],s=a[r];o.sort(function(t,e){return t.xValues[r]-e.xValues[r]});var l=t(s);n[0].splice(i,0,l),h&&n[1]&&n[1].splice(i,0,l),o.forEach(function(t){var e=t.name;s&&!c(e)&&(e=s.isDatetimeAxis?(t.x instanceof Date&&(t.x=t.x.getTime()),m.dateFormat(x.dateFormat,t.x)):s.categories?T(s.names[t.x],s.categories[t.x],t.x):t.x),t.splice(i,0,e)})}return n=n.concat(o),d(this,"exportData",{dataRows:n}),n},C.Chart.prototype.getCSV=function(t){var n="",r=this.getDataRows(),e=this.options.exporting.csv,i=T(e.decimalPoint,","!==e.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),s=T(e.itemDelimiter,","===i?";":","),l=e.lineDelimiter;return r.forEach(function(t,e){for(var a,o=t.length;o--;)"string"==typeof(a=t[o])&&(a='"'+a+'"'),"number"==typeof a&&"."!==i&&(a=a.toString().replace(".",i)),t[o]=a;n+=t.join(s),e<r.length-1&&(n+=l)}),n},C.Chart.prototype.getTable=function(t){var a='<table id="highcharts-data-table-'+this.index+'">',l=this.options,r=t?1.1.toLocaleString()[1]:".",c=T(l.exporting.useMultiLevelHeaders,!0);t=this.getDataRows(c);function p(t,e,a,o){var n=T(o,"");return e="text"+(e?" "+e:""),"number"==typeof n?(n=n.toString(),","===r&&(n=n.replace(".",r)),e="number"):o||(e="empty"),"<"+t+(a?" "+a:"")+' class="'+e+'">'+n+"</"+t+">"}var o=0,e=c?t.shift():null,n=t.shift();!1!==l.exporting.tableCaption&&(a+='<caption class="highcharts-table-caption">'+T(l.exporting.tableCaption,l.title.text?l.title.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):"Chart")+"</caption>");for(var i=0,s=t.length;i<s;++i)t[i].length>o&&(o=t[i].length);return a+=function(t,e,a){var o="<thead>",n=0;a=a||e&&e.length;var r,i=0;if(r=c&&t&&e){t:if(r=t.length,e.length===r){for(;r--;)if(t[r]!==e[r]){r=!1;break t}r=!0}else r=!1;r=!r}if(r){for(o+="<tr>";n<a;++n){r=t[n];var s=t[n+1];r===s?++i:i?(o+=p("th","highcharts-table-topheading",'scope="col" colspan="'+(i+1)+'"',r),i=0):(r===e[n]?l.exporting.useRowspanHeaders?(s=2,delete e[n]):(s=1,e[n]=""):s=1,o+=p("th","highcharts-table-topheading",'scope="col"'+(1<s?' valign="top" rowspan="'+s+'"':""),r))}o+="</tr>"}if(e){for(o+="<tr>",n=0,a=e.length;n<a;++n)void 0!==e[n]&&(o+=p("th",null,'scope="col"',e[n]));o+="</tr>"}return o+"</thead>"}(e,n,Math.max(o,n.length)),a+="<tbody>",t.forEach(function(t){a+="<tr>";for(var e=0;e<o;e++)a+=p(e?"td":"th",null,e?"":'scope="row"',t[e]);a+="</tr>"}),d(this,"afterGetTable",t={html:a+="</tbody></table>"}),t.html},C.Chart.prototype.downloadCSV=function(){var t=this.getCSV(!0);s(e(t,"text/csv")||"data:text/csv,\ufeff"+encodeURIComponent(t),this.getFilename()+".csv")},C.Chart.prototype.downloadXLS=function(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";s(e(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+i.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")},C.Chart.prototype.viewData=function(){this.dataTableDiv||(this.dataTableDiv=n.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv.innerHTML=this.getTable(),d(this,"afterViewData",this.dataTableDiv)},C.Chart.prototype.openInCloud=function(){var t=C.merge(this.userOptions);!function e(a){Object.keys(a).forEach(function(t){"function"==typeof a[t]&&delete a[t],o(a[t])&&e(a[t])})}(t),t={name:t.title&&t.title.text||"Chart title",options:t,settings:{constructor:"Chart",dataProvider:{csv:this.getCSV()}}};var a=JSON.stringify(t);!function(){var t=n.createElement("form");n.body.appendChild(t),t.method="post",t.action="https://cloud-api.highcharts.com/openincloud",t.target="_blank";var e=n.createElement("input");e.type="hidden",e.name="chart",e.value=a,t.appendChild(e),t.submit(),n.body.removeChild(t)}()},(t=C.getOptions().exporting)&&(a(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.viewData()}},openInCloud:{textKey:"openInCloud",onclick:function(){this.openInCloud()}}}),t.buttons&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData","openInCloud")),r.map&&(r.map.prototype.exportKey="name"),r.mapbubble&&(r.mapbubble.prototype.exportKey="name"),r.treemap&&(r.treemap.prototype.exportKey="name")}),e(t,"masters/modules/export-data.src.js",[],function(){})});