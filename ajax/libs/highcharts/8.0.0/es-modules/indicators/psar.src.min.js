"use strict";import H from"../parts/Globals.js";import"../parts/Utilities.js";function toFixed(t,e){return parseFloat(t.toFixed(e))}function calculateDirection(t,e,i,n){return 1===t&&e>n||-1===t&&i>n?1:-1}function getAccelerationFactor(t,e,i,n,a,r,c,o){return t===e?1===t&&i>n?a===c?c:toFixed(a+r,2):-1===t&&i<n?a===c?c:toFixed(a+r,2):a:o}function getExtremePoint(t,e,i,n){return 1===i?t>n?t:n:e<n?e:n}function getEPMinusPSAR(t,e){return t-e}function getAccelerationFactorMultiply(t,e){return t*e}function getPSAR(t,e,i,n,a,r,c,o,l){return t===e?1===t?i+n<Math.min(a,r)?i+n:Math.min(a,r):i+n>Math.max(o,c)?i+n:Math.max(o,c):l}H.seriesType("psar","sma",{lineWidth:0,marker:{enabled:!0},states:{hover:{lineWidthPlus:0}},params:{initialAccelerationFactor:.02,maxAccelerationFactor:.2,increment:.02,index:2,decimals:4}},{nameComponents:!1,getValues:function(t,e){var i,n,a,r,c,o,l,u,s,m,F,x,p=t.xData,h=t.yData,A=h[0][1],d=e.initialAccelerationFactor,g=e.maxAccelerationFactor,f=e.increment,M=e.initialAccelerationFactor,P=h[0][2],y=e.decimals,D=e.index,E=[],R=[],S=[],v=1;if(!(D>=h.length)){for(x=0;x<D;x++)A=Math.max(h[x][1],A),P=Math.min(h[x][2],toFixed(P,y));for(i=h[x][1]>P?1:-1,n=getEPMinusPSAR(A,P),a=getAccelerationFactorMultiply(d=e.initialAccelerationFactor,n),E.push([p[D],P]),R.push(p[D]),S.push(toFixed(P,y)),x=D+1;x<h.length;x++)c=h[x-1][2],o=h[x-2][2],l=h[x-1][1],u=h[x-2][1],m=h[x][1],F=h[x][2],null!==o&&null!==u&&null!==c&&null!==l&&null!==m&&null!==F&&(P=getPSAR(i,v,P,a,o,c,l,u,A),s=getExtremePoint(m,F,i,A),a=getAccelerationFactorMultiply(d=getAccelerationFactor(r=calculateDirection(v,F,m,P),i,s,A,d,f,g,M),n=getEPMinusPSAR(s,P)),E.push([p[x],toFixed(P,y)]),R.push(p[x]),S.push(toFixed(P,y)),v=i,i=r,A=s);return{values:E,xData:R,yData:S}}}});