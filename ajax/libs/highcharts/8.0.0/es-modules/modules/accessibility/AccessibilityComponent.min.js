"use strict";import H from"../../parts/Globals.js";var win=H.win,doc=win.document,merge=H.merge,fireEvent=H.fireEvent;import U from"../../parts/Utilities.js";var extend=U.extend;import HTMLUtilities from"./utils/htmlUtilities.js";var removeElement=HTMLUtilities.removeElement,getFakeMouseEvent=HTMLUtilities.getFakeMouseEvent;import ChartUtilities from"./utils/chartUtilities.js";var unhideChartElementFromAT=ChartUtilities.unhideChartElementFromAT;import EventProvider from"./utils/EventProvider.js";import DOMElementProvider from"./utils/DOMElementProvider.js";var functionsToOverrideByDerivedClasses={init:function(){},getKeyboardNavigation:function(){},onChartUpdate:function(){},onChartRender:function(){},destroy:function(){}};function AccessibilityComponent(){}AccessibilityComponent.prototype={initBase:function(e){this.chart=e,this.eventProvider=new EventProvider,this.domElementProvider=new DOMElementProvider,this.keyCodes={left:37,right:39,up:38,down:40,enter:13,space:32,esc:27,tab:9}},addEvent:function(){return this.eventProvider.addEvent.apply(this.eventProvider,arguments)},createElement:function(){return this.domElementProvider.createElement.apply(this.domElementProvider,arguments)},fireEventOnWrappedOrUnwrappedElement:function(e,t){var n=t.type;doc.createEvent&&(e.dispatchEvent||e.fireEvent)?e.dispatchEvent?e.dispatchEvent(t):e.fireEvent(n,t):fireEvent(e,n,t)},fakeClickEvent:function(e){if(e){var t=getFakeMouseEvent("click");this.fireEventOnWrappedOrUnwrappedElement(e,t)}},addProxyGroup:function(e){this.createOrUpdateProxyContainer();var t=this.createElement("div");return Object.keys(e||{}).forEach(function(n){null!==e[n]&&t.setAttribute(n,e[n])}),this.chart.a11yProxyContainer.appendChild(t),t},createOrUpdateProxyContainer:function(){var e=this.chart,t=e.renderer.box;e.a11yProxyContainer=e.a11yProxyContainer||this.createProxyContainerElement(),t.nextSibling!==e.a11yProxyContainer&&e.container.insertBefore(e.a11yProxyContainer,t.nextSibling)},createProxyContainerElement:function(){var e=doc.createElement("div");return e.className="highcharts-a11y-proxy-container",e},createProxyButton:function(e,t,n,r,i){var o=e.element,a=this.createElement("button"),s=merge({"aria-label":o.getAttribute("aria-label")},n),c=this.getElementPosition(r||e);return Object.keys(s).forEach(function(e){null!==s[e]&&a.setAttribute(e,s[e])}),a.className="highcharts-a11y-proxy-button",i&&this.addEvent(a,"click",i),this.setProxyButtonStyle(a,c),this.proxyMouseEventsForButton(o,a),t.appendChild(a),s["aria-hidden"]||unhideChartElementFromAT(this.chart,a),a},getElementPosition:function(e){var t=e.element,n=this.chart.renderTo;if(n&&t&&t.getBoundingClientRect){var r=t.getBoundingClientRect(),i=n.getBoundingClientRect();return{x:r.left-i.left,y:r.top-i.top,width:r.right-r.left,height:r.bottom-r.top}}return{x:0,y:0,width:1,height:1}},setProxyButtonStyle:function(e,t){merge(!0,e.style,{"border-width":0,"background-color":"transparent",cursor:"pointer",outline:"none",opacity:.001,filter:"alpha(opacity=1)","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=1)",zIndex:999,overflow:"hidden",padding:0,margin:0,display:"block",position:"absolute",width:(t.width||1)+"px",height:(t.height||1)+"px",left:(t.x||0)+"px",top:(t.y||0)+"px"})},proxyMouseEventsForButton:function(e,t){var n=this;["click","touchstart","touchend","touchcancel","touchmove","mouseover","mouseenter","mouseleave","mouseout"].forEach(function(r){n.addEvent(t,r,function(t){var r=n.cloneMouseEvent(t);e&&n.fireEventOnWrappedOrUnwrappedElement(e,r),t.stopPropagation(),t.preventDefault()})})},cloneMouseEvent:function(e){if("function"==typeof win.MouseEvent)return new win.MouseEvent(e.type,e);if(doc.createEvent){var t=doc.createEvent("MouseEvent");if(t.initMouseEvent)return t.initMouseEvent(e.type,e.bubbles,e.cancelable,e.view||win,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget),t}return getFakeMouseEvent(e.type)},destroyBase:function(){removeElement(this.chart.a11yProxyContainer),this.domElementProvider.destroyCreatedElements(),this.eventProvider.removeAddedEvents()}},extend(AccessibilityComponent.prototype,functionsToOverrideByDerivedClasses);export default AccessibilityComponent;