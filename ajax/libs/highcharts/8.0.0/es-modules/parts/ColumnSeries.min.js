"use strict";import H from"./Globals.js";import U from"./Utilities.js";var animObject=U.animObject,clamp=U.clamp,defined=U.defined,extend=U.extend,isNumber=U.isNumber,pick=U.pick;import"./Color.js";import"./Legend.js";import"./Series.js";import"./Options.js";var color=H.color,LegendSymbolMixin=H.LegendSymbolMixin,merge=H.merge,noop=H.noop,Series=H.Series,seriesType=H.seriesType,svg=H.svg;seriesType("column","line",{borderRadius:0,crisp:!0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"},{cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){Series.prototype.init.apply(this,arguments);var t=this,e=t.chart;e.hasRendered&&e.series.forEach(function(e){e.type===t.type&&(e.isDirty=!0)})},getColumnMetrics:function(){var t,e=this,o=e.options,i=e.xAxis,r=e.yAxis,s=i.options.reversedStacks,n=i.reversed&&!s||!i.reversed&&s,a={},p=0;!1===o.grouping?p=1:e.chart.series.forEach(function(o){var i,s=o.yAxis,n=o.options;o.type!==e.type||!o.visible&&e.chart.options.chart.ignoreHiddenSeries||r.len!==s.len||r.pos!==s.pos||(n.stacking?(t=o.stackKey,void 0===a[t]&&(a[t]=p++),i=a[t]):!1!==n.grouping&&(i=p++),o.columnIndex=i)});var d=Math.min(Math.abs(i.transA)*(i.ordinalSlope||o.pointRange||i.closestPointRange||i.tickInterval||1),i.len),l=d*o.groupPadding,h=(d-2*l)/(p||1),c=Math.min(o.maxPointWidth||i.len,pick(o.pointWidth,h*(1-2*o.pointPadding))),g=(h-c)/2+(l+((e.columnIndex||0)+(n?1:0))*h-d/2)*(n?-1:1);return e.columnMetrics={width:c,offset:g},e.columnMetrics},crispCol:function(t,e,o,i){var r,s,n=this.chart,a=this.borderWidth,p=-(a%2?.5:0),d=a%2?.5:1;return n.inverted&&n.renderer.isVML&&(d+=1),this.options.crisp&&(o=Math.round(t+o)+p-(t=Math.round(t)+p)),r=Math.round(e+i)+d,s=Math.abs(e)<=.5&&r>.5,i=r-(e=Math.round(e)+d),s&&i&&(e-=1,i+=1),{x:t,y:e,width:o,height:i}},translate:function(){var t=this,e=t.chart,o=t.options,i=t.dense=t.closestPointRange*t.xAxis.transA<2,r=t.borderWidth=pick(o.borderWidth,i?0:1),s=t.yAxis,n=o.threshold,a=t.translatedThreshold=s.getThreshold(n),p=pick(o.minPointLength,5),d=t.getColumnMetrics(),l=d.width,h=t.barW=Math.max(l,1+2*r),c=t.pointXOffset=d.offset,g=t.dataMin,u=t.dataMax;e.inverted&&(a-=.5),o.pointPadding&&(h=Math.ceil(h)),Series.prototype.translate.apply(t),t.points.forEach(function(o){var i,r=pick(o.yBottom,a),d=999+Math.abs(r),m=l,y=clamp(o.plotY,-d,s.len+d),b=o.plotX+c,f=h,v=Math.min(y,r),x=Math.max(y,r)-v;p&&Math.abs(x)<p&&(x=p,i=!s.reversed&&!o.negative||s.reversed&&o.negative,o.y===n&&t.dataMax<=n&&s.min<n&&g!==u&&(i=!i),v=Math.abs(v-a)>p?r-p:a-(i?p:0)),defined(o.options.pointWidth)&&(m=f=Math.ceil(o.options.pointWidth),b-=Math.round((m-l)/2)),o.barX=b,o.pointWidth=m,o.tooltipPos=e.inverted?[s.len+s.pos-e.plotLeft-y,t.xAxis.len-b-f/2,x]:[b+f/2,y+s.pos-e.plotTop,x],o.shapeType=t.pointClass.prototype.shapeType||"rect",o.shapeArgs=t.crispCol.apply(t,o.isNull?[b,a,f,0]:[b,v,f,x])})},getSymbol:noop,drawLegendSymbol:LegendSymbolMixin.drawRectangle,drawGraph:function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},pointAttribs:function(t,e){var o,i,r,s,n=this.options,a=this.pointAttrToOptions||{},p=a.stroke||"borderColor",d=a["stroke-width"]||"borderWidth",l=t&&t.color||this.color,h=t&&t[p]||n[p]||this.color||l,c=t&&t[d]||n[d]||this[d]||0,g=t&&t.options.dashStyle||n.dashStyle,u=pick(t&&t.opacity,n.opacity,1);return t&&this.zones.length&&(r=t.getZone(),l=t.options.color||r&&(r.color||t.nonZonedColor)||this.color,r&&(h=r.borderColor||h,g=r.dashStyle||g,c=r.borderWidth||c)),e&&t&&(s=(o=merge(n.states[e],t.options.states&&t.options.states[e]||{})).brightness,l=o.color||void 0!==s&&color(l).brighten(o.brightness).get()||l,h=o[p]||h,c=o[d]||c,g=o.dashStyle||g,u=pick(o.opacity,u)),i={fill:l,stroke:h,"stroke-width":c,opacity:u},g&&(i.dashstyle=g),i},drawPoints:function(){var t,e=this,o=this.chart,i=e.options,r=o.renderer,s=i.animationLimit||250;e.points.forEach(function(n){var a=n.plotY,p=n.graphic,d=!!p,l=p&&o.pointCount<s?"animate":"attr";isNumber(a)&&null!==n.y?(t=n.shapeArgs,p&&n.hasNewShapeType()&&(p=p.destroy()),e.enabledDataSorting&&(n.startXPos=e.xAxis.reversed?-(t?t.width:0):e.xAxis.width),p||(n.graphic=p=r[n.shapeType](t).add(n.group||e.group),p&&e.enabledDataSorting&&o.hasRendered&&o.pointCount<s&&(p.attr({x:n.startXPos}),d=!0,l="animate")),p&&d&&p[l](merge(t)),i.borderRadius&&p[l]({r:i.borderRadius}),o.styledMode||p[l](e.pointAttribs(n,n.selected&&"select")).shadow(!1!==n.allowShadow&&i.shadow,null,i.stacking&&!i.borderRadius),p.addClass(n.getClassName(),!0)):p&&(n.graphic=p.destroy())})},animate:function(t){var e,o,i=this,r=this.yAxis,s=i.options,n=this.chart.inverted,a={},p=n?"translateX":"translateY";svg&&(t?(a.scaleY=.001,o=clamp(r.toPixels(s.threshold),r.pos,r.pos+r.len),n?a.translateX=o-r.len:a.translateY=o,i.clipBox&&i.setClip(),i.group.attr(a)):(e=i.group.attr(p),i.group.animate({scaleY:1},extend(animObject(i.options.animation),{step:function(t,o){a[p]=e+o.pos*(r.pos-e),i.group.attr(a)}})),i.animate=null))},remove:function(){var t=this,e=t.chart;e.hasRendered&&e.series.forEach(function(e){e.type===t.type&&(e.isDirty=!0)}),Series.prototype.remove.apply(t,arguments)}});