"use strict";import H from"./Globals.js";import U from"./Utilities.js";var defined=U.defined,isNumber=U.isNumber,objectEach=U.objectEach,wrap=U.wrap;import"./Series.js";import"./SvgRenderer.js";import onSeriesMixin from"../mixins/on-series.js";var addEvent=H.addEvent,merge=H.merge,noop=H.noop,Renderer=H.Renderer,Series=H.Series,seriesType=H.seriesType,SVGRenderer=H.SVGRenderer,TrackerMixin=H.TrackerMixin,VMLRenderer=H.VMLRenderer,symbols=SVGRenderer.prototype.symbols;function createPinSymbol(e){symbols[e+"pin"]=function(t,i,r,o,n){var s,a,l=n&&n.anchorX,p=n&&n.anchorY;return"circle"===e&&o>r&&(t-=Math.round((o-r)/2),r=o),s=symbols[e](t,i,r,o),l&&p&&(a=i>p?i:i+o,s.push("M","circle"===e?t+r/2:s[1]+s[4]/2,a,"L",l,p),s=s.concat(symbols.circle(l-1,p-1,2,2))),s}}seriesType("flags","column",{pointRange:0,allowOverlapX:!1,shape:"flag",stackDistance:12,textAlign:"center",tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30,fillColor:"#ffffff",lineWidth:1,states:{hover:{lineColor:"#000000",fillColor:"#ccd6eb"}},style:{fontSize:"11px",fontWeight:"bold"}},{sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:Series.prototype.init,pointAttribs:function(e,t){var i=this.options,r=e&&e.color||this.color,o=i.lineColor,n=e&&e.lineWidth,s=e&&e.fillColor||i.fillColor;return t&&(s=i.states[t].fillColor,o=i.states[t].lineColor,n=i.states[t].lineWidth),{fill:s||r,stroke:o||r,"stroke-width":n||i.lineWidth||0}},translate:onSeriesMixin.translate,getPlotBox:onSeriesMixin.getPlotBox,drawPoints:function(){var e,t,i,r,o,n,s,a,l,p,c,h=this.points,d=this.chart,f=d.renderer,u=d.inverted,y=this.options,m=y.y,g=this.yAxis,v={},b=[];for(r=h.length;r--;)o=h[r],p=(u?o.plotY:o.plotX)>this.xAxis.len,e=o.plotX,s=o.stackIndex,i=o.options.shape||y.shape,void 0!==(t=o.plotY)&&(t=o.plotY+m-(void 0!==s&&s*y.stackDistance)),o.anchorX=s?void 0:o.plotX,a=s?void 0:o.plotY,c="flag"!==i,n=o.graphic,void 0!==t&&e>=0&&!p?(n||(n=o.graphic=f.label("",null,null,i,null,null,y.useHTML),d.styledMode||n.attr(this.pointAttribs(o)).css(merge(y.style,o.style)),n.attr({align:c?"center":"left",width:y.width,height:y.height,"text-align":y.textAlign}).addClass("highcharts-point").add(this.markerGroup),o.graphic.div&&(o.graphic.div.point=o),d.styledMode||n.shadow(y.shadow),n.isNew=!0),e>0&&(e-=n.strokeWidth()%2),l={y:t,anchorY:a},y.allowOverlapX&&(l.x=e,l.anchorX=o.anchorX),n.attr({text:o.options.title||y.title||"A"})[n.isNew?"attr":"animate"](l),y.allowOverlapX||(v[o.plotX]?v[o.plotX].size=Math.max(v[o.plotX].size,n.width):v[o.plotX]={align:c?.5:0,size:n.width,target:e,anchorX:e}),o.tooltipPos=[e,t+g.pos-d.plotTop]):n&&(o.graphic=n.destroy());y.allowOverlapX||(objectEach(v,function(e){e.plotX=e.anchorX,b.push(e)}),H.distribute(b,u?g.len:this.xAxis.len,100),h.forEach(function(e){var t=e.graphic&&v[e.plotX];t&&(e.graphic[e.graphic.isNew?"attr":"animate"]({x:t.pos+t.align*t.size,anchorX:e.anchorX}),defined(t.pos)?e.graphic.isNew=!1:(e.graphic.attr({x:-9999,anchorX:-9999}),e.graphic.isNew=!0))})),y.useHTML&&wrap(this.markerGroup,"on",function(e){return H.SVGElement.prototype.on.apply(e.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})},drawTracker:function(){var e=this.points;TrackerMixin.drawTrackerPoint.apply(this),e.forEach(function(t){var i=t.graphic;i&&addEvent(i.element,"mouseover",function(){t.stackIndex>0&&!t.raised&&(t._y=i.y,i.attr({y:t._y-8}),t.raised=!0),e.forEach(function(e){e!==t&&e.raised&&e.graphic&&(e.graphic.attr({y:e._y}),e.raised=!1)})})})},animate:function(e){e?this.setClip():this.animate=null},setClip:function(){Series.prototype.setClip.apply(this,arguments),!1!==this.options.clip&&this.sharedClipKey&&this.markerGroup.clip(this.chart[this.sharedClipKey])},buildKDTree:noop,invertGroups:noop},{isValid:function(){return isNumber(this.y)||void 0===this.y}}),symbols.flag=function(e,t,i,r,o){var n=o&&o.anchorX||e,s=o&&o.anchorY||t;return symbols.circle(n-1,s-1,2,2).concat(["M",n,s,"L",e,t+r,e,t,e+i,t,e+i,t+r,e,t+r,"Z"])},createPinSymbol("circle"),createPinSymbol("square"),Renderer===VMLRenderer&&["circlepin","flag","squarepin"].forEach(function(e){VMLRenderer.prototype.symbols[e]=symbols[e]});