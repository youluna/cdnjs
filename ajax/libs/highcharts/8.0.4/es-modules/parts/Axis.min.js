"use strict";import H from"./Globals.js";import Color from"./Color.js";var color=Color.parse;import Tick from"./Tick.js";import U from"./Utilities.js";var addEvent=U.addEvent,animObject=U.animObject,arrayMax=U.arrayMax,arrayMin=U.arrayMin,clamp=U.clamp,correctFloat=U.correctFloat,defined=U.defined,destroyObjectProperties=U.destroyObjectProperties,error=U.error,extend=U.extend,fireEvent=U.fireEvent,format=U.format,getMagnitude=U.getMagnitude,isArray=U.isArray,isFunction=U.isFunction,isNumber=U.isNumber,isString=U.isString,merge=U.merge,normalizeTickInterval=U.normalizeTickInterval,objectEach=U.objectEach,pick=U.pick,relativeLength=U.relativeLength,removeEvent=U.removeEvent,splat=U.splat,syncTimeout=U.syncTimeout;import"./Options.js";var defaultOptions=H.defaultOptions,deg2rad=H.deg2rad,Axis=function(){this.init.apply(this,arguments)};extend(Axis.prototype,{defaultOptions:{dateTimeLabelFormats:{millisecond:{main:"%H:%M:%S.%L",range:!1},second:{main:"%H:%M:%S",range:!1},minute:{main:"%H:%M",range:!1},hour:{main:"%H:%M",range:!1},day:{main:"%e. %b"},week:{main:"%e. %b"},month:{main:"%b '%y"},year:{main:"%Y"}},endOnTick:!1,labels:{enabled:!0,indentation:10,x:0,style:{color:"#666666",cursor:"default",fontSize:"11px"}},maxPadding:.01,minorTickLength:2,minorTickPosition:"outside",minPadding:.01,showEmpty:!0,startOfWeek:1,startOnTick:!1,tickLength:10,tickPixelInterval:100,tickmarkPlacement:"between",tickPosition:"outside",title:{align:"middle",style:{color:"#666666"}},type:"linear",minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",tickColor:"#ccd6eb"},defaultYAxisOptions:{endOnTick:!0,maxPadding:.05,minPadding:.05,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{allowOverlap:!1,enabled:!1,crop:!0,overflow:"justify",formatter:function(){return(0,this.axis.chart.numberFormatter)(this.total,-1)},style:{color:"#000000",fontSize:"11px",fontWeight:"bold",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},margin:15,title:{rotation:0}},init:function(i,t){var e=t.isX,s=this;s.chart=i,s.horiz=i.inverted&&!s.isZAxis?!e:e,s.isXAxis=e,s.coll=s.coll||(e?"xAxis":"yAxis"),fireEvent(this,"init",{userOptions:t}),s.opposite=t.opposite,s.side=t.side||(s.horiz?s.opposite?0:2:s.opposite?1:3),s.setOptions(t);var n=this.options,a=n.type,o="datetime"===a;s.labelFormatter=n.labels.formatter||s.defaultLabelFormatter,s.userOptions=t,s.minPixelPadding=0,s.reversed=n.reversed,s.visible=!1!==n.visible,s.zoomEnabled=!1!==n.zoomEnabled,s.hasNames="category"===a||!0===n.categories,s.categories=n.categories||s.hasNames,s.names||(s.names=[],s.names.keys={}),s.plotLinesAndBandsGroups={},s.isLog="logarithmic"===a,s.isDatetimeAxis=o,s.positiveValuesOnly=s.isLog&&!s.allowNegativeLog,s.isLinked=defined(n.linkedTo),s.ticks={},s.labelEdge=[],s.minorTicks={},s.plotLinesAndBands=[],s.alternateBands={},s.len=0,s.minRange=s.userMinRange=n.minRange||n.maxZoom,s.range=n.range,s.offset=n.offset||0,s.stacks={},s.oldStacks={},s.stacksTouched=0,s.max=null,s.min=null,s.crosshair=pick(n.crosshair,splat(i.options.tooltip.crosshairs)[e?0:1],!1);var r=s.options.events;-1===i.axes.indexOf(s)&&(e?i.axes.splice(i.xAxis.length,0,s):i.axes.push(s),i[s.coll].push(s)),s.series=s.series||[],i.inverted&&!s.isZAxis&&e&&void 0===s.reversed&&(s.reversed=!0),objectEach(r,function(i,t){isFunction(i)&&addEvent(s,t,i)}),s.lin2log=n.linearToLogConverter||s.lin2log,s.isLog&&(s.val2lin=s.log2lin,s.lin2val=s.lin2log),fireEvent(this,"afterInit")},setOptions:function(i){this.options=merge(this.defaultOptions,"yAxis"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],merge(defaultOptions[this.coll],i)),fireEvent(this,"afterSetOptions",{userOptions:i})},defaultLabelFormatter:function(){var i,t,e=this.axis,s=this.value,n=e.chart.time,a=e.categories,o=this.dateTimeLabelFormat,r=defaultOptions.lang,h=r.numericSymbols,l=r.numericSymbolMagnitude||1e3,c=h&&h.length,d=e.options.labels.format,m=e.isLog?Math.abs(s):e.tickInterval,f=this.chart,g=f.numberFormatter;if(d)t=format(d,this,f);else if(a)t=s;else if(o)t=n.dateFormat(o,s);else if(c&&m>=1e3)for(;c--&&void 0===t;)m>=(i=Math.pow(l,c+1))&&10*s%i==0&&null!==h[c]&&0!==s&&(t=g(s/i,-1)+h[c]);return void 0===t&&(t=Math.abs(s)>=1e4?g(s,-1):g(s,-1,void 0,"")),t},getSeriesExtremes:function(){var i,t=this,e=t.chart;fireEvent(this,"getSeriesExtremes",null,function(){t.hasVisibleSeries=!1,t.dataMin=t.dataMax=t.threshold=null,t.softThreshold=!t.isXAxis,t.buildStacks&&t.buildStacks(),t.series.forEach(function(s){if(s.visible||!e.options.chart.ignoreHiddenSeries){var n,a,o,r=s.options,h=r.threshold;t.hasVisibleSeries=!0,t.positiveValuesOnly&&h<=0&&(h=null),t.isXAxis?(n=s.xData).length&&(a=(i=s.getXExtremes(n)).min,o=i.max,isNumber(a)||a instanceof Date||(n=n.filter(isNumber),a=(i=s.getXExtremes(n)).min,o=i.max),n.length&&(t.dataMin=Math.min(pick(t.dataMin,a),a),t.dataMax=Math.max(pick(t.dataMax,o),o))):(s.getExtremes(),o=s.dataMax,a=s.dataMin,defined(a)&&defined(o)&&(t.dataMin=Math.min(pick(t.dataMin,a),a),t.dataMax=Math.max(pick(t.dataMax,o),o)),defined(h)&&(t.threshold=h),r.softThreshold&&!t.positiveValuesOnly||(t.softThreshold=!1))}})}),fireEvent(this,"afterGetSeriesExtremes")},translate:function(i,t,e,s,n,a){var o=this.linkedParent||this,r=1,h=0,l=s?o.oldTransA:o.transA,c=s?o.oldMin:o.min,d=0,m=o.minPixelPadding,f=(o.isOrdinal||o.isBroken||o.isLog&&n)&&o.lin2val;return l||(l=o.transA),e&&(r*=-1,h=o.len),o.reversed&&(h-=(r*=-1)*(o.sector||o.len)),t?(i=i*r+h,d=(i-=m)/l+c,f&&(d=o.lin2val(d))):(f&&(i=o.val2lin(i)),d=isNumber(c)?r*(i-c)*l+h+r*m+(isNumber(a)?l*a:0):void 0),d},toPixels:function(i,t){return this.translate(i,!1,!this.horiz,null,!0)+(t?0:this.pos)},toValue:function(i,t){return this.translate(i-(t?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(i){var t,e,s,n,a,o,r=this,h=r.chart,l=r.left,c=r.top,d=i.old,m=i.value,f=i.translatedValue,g=i.lineWidth,u=i.force,x=d&&h.oldChartHeight||h.chartHeight,p=d&&h.oldChartWidth||h.chartWidth,k=r.transB,v=function(i,t,e){return("pass"!==u&&i<t||i>e)&&(u?i=clamp(i,t,e):a=!0),i};return o={value:m,lineWidth:g,old:d,force:u,acrossPanes:i.acrossPanes,translatedValue:f},fireEvent(this,"getPlotLinePath",o,function(i){f=pick(f,r.translate(m,null,null,d)),f=clamp(f,-1e5,1e5),t=s=Math.round(f+k),e=n=Math.round(x-f-k),isNumber(f)?r.horiz?(e=c,n=x-r.bottom,t=s=v(t,l,l+r.width)):(t=l,s=p-r.right,e=n=v(e,c,c+r.height)):(a=!0,u=!1),i.path=a&&!u?null:h.renderer.crispLine(["M",t,e,"L",s,n],g||1)}),o.path},getLinearTickPositions:function(i,t,e){var s,n,a,o=correctFloat(Math.floor(t/i)*i),r=correctFloat(Math.ceil(e/i)*i),h=[];if(correctFloat(o+i)===o&&(a=20),this.single)return[t];for(s=o;s<=r&&(h.push(s),(s=correctFloat(s+i,a))!==n);)n=s;return h},getMinorTickInterval:function(){var i=this.options;return!0===i.minorTicks?pick(i.minorTickInterval,"auto"):!1===i.minorTicks?null:i.minorTickInterval},getMinorTickPositions:function(){var i,t=this,e=t.options,s=t.tickPositions,n=t.minorTickInterval,a=[],o=t.pointRangePadding||0,r=t.min-o,h=t.max+o,l=h-r;if(l&&l/n<t.len/3)if(t.isLog)this.paddedTicks.forEach(function(i,e,s){e&&a.push.apply(a,t.getLogTickPositions(n,s[e-1],s[e],!0))});else if(t.isDatetimeAxis&&"auto"===this.getMinorTickInterval())a=a.concat(t.getTimeTicks(t.normalizeTimeTickInterval(n),r,h,e.startOfWeek));else for(i=r+(s[0]-r)%n;i<=h&&i!==a[0];i+=n)a.push(i);return 0!==a.length&&t.trimTicks(a),a},adjustForMinRange:function(){var i,t,e,s,n,a,o,r,h,l,c=this.options,d=this.min,m=this.max;this.isXAxis&&void 0===this.minRange&&!this.isLog&&(defined(c.min)||defined(c.max)?this.minRange=null:(this.series.forEach(function(i){for(a=i.xData,o=i.xIncrement?1:a.length-1,s=o;s>0;s--)n=a[s]-a[s-1],(void 0===e||n<e)&&(e=n)}),this.minRange=Math.min(5*e,this.dataMax-this.dataMin))),m-d<this.minRange&&(t=this.dataMax-this.dataMin>=this.minRange,r=[d-(i=((l=this.minRange)-m+d)/2),pick(c.min,d-i)],t&&(r[2]=this.isLog?this.log2lin(this.dataMin):this.dataMin),h=[(d=arrayMax(r))+l,pick(c.max,d+l)],t&&(h[2]=this.isLog?this.log2lin(this.dataMax):this.dataMax),(m=arrayMin(h))-d<l&&(r[0]=m-l,r[1]=pick(c.min,m-l),d=arrayMax(r))),this.min=d,this.max=m},getClosest:function(){var i;return this.categories?i=1:this.series.forEach(function(t){var e=t.closestPointRange,s=t.visible||!t.chart.options.chart.ignoreHiddenSeries;!t.noSharedTooltip&&defined(e)&&s&&(i=defined(i)?Math.min(i,e):e)}),i},nameToX:function(i){var t,e=isArray(this.categories),s=e?this.categories:this.names,n=i.options.x;return i.series.requireSorting=!1,defined(n)||(n=!1===this.options.uniqueNames?i.series.autoIncrement():e?s.indexOf(i.name):pick(s.keys[i.name],-1)),-1===n?e||(t=s.length):t=n,void 0!==t&&(this.names[t]=i.name,this.names.keys[i.name]=t),t},updateNames:function(){var i=this,t=this.names;t.length>0&&(Object.keys(t.keys).forEach(function(i){delete t.keys[i]}),t.length=0,this.minRange=this.userMinRange,(this.series||[]).forEach(function(t){t.xIncrement=null,t.points&&!t.isDirtyData||(i.max=Math.max(i.max,t.xData.length-1),t.processData(),t.generatePoints()),t.data.forEach(function(e,s){var n;e&&e.options&&void 0!==e.name&&void 0!==(n=i.nameToX(e))&&n!==e.x&&(e.x=n,t.xData[s]=n)})}))},setAxisTranslation:function(i){var t,e,s=this,n=s.max-s.min,a=s.axisPointRange||0,o=0,r=0,h=s.linkedParent,l=!!s.categories,c=s.transA,d=s.isXAxis;(d||l||a)&&(t=s.getClosest(),h?(o=h.minPointOffset,r=h.pointRangePadding):s.series.forEach(function(i){var e=l?1:d?pick(i.options.pointRange,t,0):s.axisPointRange||0,n=i.options.pointPlacement;if(a=Math.max(a,e),!s.single||l){var h=i.is("xrange")?!d:d;o=Math.max(o,h&&isString(n)?0:e/2),r=Math.max(r,h&&"on"===n?0:e)}}),e=s.ordinalSlope&&t?s.ordinalSlope/t:1,s.minPointOffset=o*=e,s.pointRangePadding=r*=e,s.pointRange=Math.min(a,s.single&&l?1:n),d&&(s.closestPointRange=t)),i&&(s.oldTransA=c),s.translationSlope=s.transA=c=s.staticScale||s.len/(n+r||1),s.transB=s.horiz?s.left:s.bottom,s.minPixelPadding=c*o,fireEvent(this,"afterSetAxisTranslation")},minFromRange:function(){return this.max-this.range},setTickInterval:function(i){var t,e,s,n,a,o,r,h=this,l=h.chart,c=h.options,d=h.isLog,m=h.isDatetimeAxis,f=h.isXAxis,g=h.isLinked,u=c.maxPadding,x=c.minPadding,p=c.tickInterval,k=c.tickPixelInterval,v=h.categories,M=isNumber(h.threshold)?h.threshold:null,b=h.softThreshold;m||v||g||this.getTickAmount(),o=pick(h.userMin,c.min),r=pick(h.userMax,c.max),g?(h.linkedParent=l[h.coll][c.linkedTo],e=h.linkedParent.getExtremes(),h.min=pick(e.min,e.dataMin),h.max=pick(e.max,e.dataMax),c.type!==h.linkedParent.options.type&&error(11,1,l)):(!b&&defined(M)&&(h.dataMin>=M?(n=M,x=0):h.dataMax<=M&&(a=M,u=0)),h.min=pick(o,n,h.dataMin),h.max=pick(r,a,h.dataMax)),d&&(h.positiveValuesOnly&&!i&&Math.min(h.min,pick(h.dataMin,h.min))<=0&&error(10,1,l),h.min=correctFloat(h.log2lin(h.min),16),h.max=correctFloat(h.log2lin(h.max),16)),h.range&&defined(h.max)&&(h.userMin=h.min=o=Math.max(h.dataMin,h.minFromRange()),h.userMax=r=h.max,h.range=null),fireEvent(h,"foundExtremes"),h.beforePadding&&h.beforePadding(),h.adjustForMinRange(),v||h.axisPointRange||h.usePercentage||g||!defined(h.min)||!defined(h.max)||(t=h.max-h.min)&&(!defined(o)&&x&&(h.min-=t*x),!defined(r)&&u&&(h.max+=t*u)),isNumber(h.userMin)||(isNumber(c.softMin)&&c.softMin<h.min&&(h.min=o=c.softMin),isNumber(c.floor)&&(h.min=Math.max(h.min,c.floor))),isNumber(h.userMax)||(isNumber(c.softMax)&&c.softMax>h.max&&(h.max=r=c.softMax),isNumber(c.ceiling)&&(h.max=Math.min(h.max,c.ceiling))),b&&defined(h.dataMin)&&(M=M||0,!defined(o)&&h.min<M&&h.dataMin>=M?h.min=h.options.minRange?Math.min(M,h.max-h.minRange):M:!defined(r)&&h.max>M&&h.dataMax<=M&&(h.max=h.options.minRange?Math.max(M,h.min+h.minRange):M)),h.min===h.max||void 0===h.min||void 0===h.max?h.tickInterval=1:g&&!p&&k===h.linkedParent.options.tickPixelInterval?h.tickInterval=p=h.linkedParent.tickInterval:h.tickInterval=pick(p,this.tickAmount?(h.max-h.min)/Math.max(this.tickAmount-1,1):void 0,v?1:(h.max-h.min)*k/Math.max(h.len,k)),f&&!i&&h.series.forEach(function(i){i.processData(h.min!==h.oldMin||h.max!==h.oldMax)}),h.setAxisTranslation(!0),h.beforeSetTickPositions&&h.beforeSetTickPositions(),h.postProcessTickInterval&&(h.tickInterval=h.postProcessTickInterval(h.tickInterval)),h.pointRange&&!p&&(h.tickInterval=Math.max(h.pointRange,h.tickInterval)),s=pick(c.minTickInterval,h.isDatetimeAxis&&h.closestPointRange),!p&&h.tickInterval<s&&(h.tickInterval=s),m||d||p||(h.tickInterval=normalizeTickInterval(h.tickInterval,null,getMagnitude(h.tickInterval),pick(c.allowDecimals,!(h.tickInterval>.5&&h.tickInterval<5&&h.max>1e3&&h.max<9999)),!!this.tickAmount)),this.tickAmount||(h.tickInterval=h.unsquish()),this.setTickPositions()},setTickPositions:function(){var i,t=this.options,e=t.tickPositions,s=this.getMinorTickInterval(),n=t.tickPositioner,a=t.startOnTick,o=t.endOnTick;this.tickmarkOffset=this.categories&&"between"===t.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===s&&this.tickInterval?this.tickInterval/5:s,this.single=this.min===this.max&&defined(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==t.allowDecimals),this.tickPositions=i=e&&e.slice(),i||(!this.ordinalPositions&&(this.max-this.min)/this.tickInterval>Math.max(2*this.len,200)?(i=[this.min,this.max],error(19,!1,this.chart)):i=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,t.units),this.min,this.max,t.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max),i.length>this.len&&(i=[i[0],i.pop()])[0]===i[1]&&(i.length=1),this.tickPositions=i,n&&(n=n.apply(this,[this.min,this.max]))&&(this.tickPositions=i=n)),this.paddedTicks=i.slice(0),this.trimTicks(i,a,o),this.isLinked||(this.single&&i.length<2&&!this.categories&&!this.series.some(function(i){return i.is("heatmap")&&"between"===i.options.pointPlacement})&&(this.min-=.5,this.max+=.5),e||n||this.adjustTickAmount()),fireEvent(this,"afterSetTickPositions")},trimTicks:function(i,t,e){var s=i[0],n=i[i.length-1],a=!this.isOrdinal&&this.minPointOffset||0;if(fireEvent(this,"trimTicks"),!this.isLinked){if(t&&s!==-1/0)this.min=s;else for(;this.min-a>i[0];)i.shift();if(e)this.max=n;else for(;this.max+a<i[i.length-1];)i.pop();0===i.length&&defined(s)&&!this.options.tickPositions&&i.push((n+s)/2)}},alignToOthers:function(){var i,t={},e=this.options;return!1===this.chart.options.chart.alignTicks||!1===e.alignTicks||!1===e.startOnTick||!1===e.endOnTick||this.isLog||this.chart[this.coll].forEach(function(e){var s=e.options,n=[e.horiz?s.left:s.top,s.width,s.height,s.pane].join(",");e.series.length&&(t[n]?i=!0:t[n]=1)}),i},getTickAmount:function(){var i=this.options,t=i.tickAmount,e=i.tickPixelInterval;!defined(i.tickInterval)&&this.len<e&&!this.isRadial&&!this.isLog&&i.startOnTick&&i.endOnTick&&(t=2),!t&&this.alignToOthers()&&(t=Math.ceil(this.len/e)+1),t<4&&(this.finalTickAmt=t,t=5),this.tickAmount=t},adjustTickAmount:function(){var i,t,e,s=this.options,n=this.tickInterval,a=this.tickPositions,o=this.tickAmount,r=this.finalTickAmt,h=a&&a.length,l=pick(this.threshold,this.softThreshold?0:null);if(this.hasData()){if(h<o){for(i=this.min;a.length<o;)a.length%2||i===l?a.push(correctFloat(a[a.length-1]+n)):a.unshift(correctFloat(a[0]-n));this.transA*=(h-1)/(o-1),this.min=s.startOnTick?a[0]:Math.min(this.min,a[0]),this.max=s.endOnTick?a[a.length-1]:Math.max(this.max,a[a.length-1])}else h>o&&(this.tickInterval*=2,this.setTickPositions());if(defined(r)){for(e=t=a.length;e--;)(3===r&&e%2==1||r<=2&&e>0&&e<t-1)&&a.splice(e,1);this.finalTickAmt=void 0}}},setScale:function(){var i,t=this.series.some(function(i){return i.isDirtyData||i.isDirty||i.xAxis&&i.xAxis.isDirty});this.oldMin=this.min,this.oldMax=this.max,this.oldAxisLength=this.len,this.setAxisSize(),(i=this.len!==this.oldAxisLength)||t||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()?(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=i||this.min!==this.oldMin||this.max!==this.oldMax)):this.cleanStacks&&this.cleanStacks(),fireEvent(this,"afterSetScale")},setExtremes:function(i,t,e,s,n){var a=this,o=a.chart;e=pick(e,!0),a.series.forEach(function(i){delete i.kdTree}),n=extend(n,{min:i,max:t}),fireEvent(a,"setExtremes",n,function(){a.userMin=i,a.userMax=t,a.eventArgs=n,e&&o.redraw(s)})},zoom:function(i,t){var e=this.dataMin,s=this.dataMax,n=this.options,a=Math.min(e,pick(n.min,e)),o=Math.max(s,pick(n.max,s)),r={newMin:i,newMax:t};return fireEvent(this,"zoom",r,function(i){var t=i.newMin,n=i.newMax;t===this.min&&n===this.max||(this.allowZoomOutside||(defined(e)&&(t<a&&(t=a),t>o&&(t=o)),defined(s)&&(n<a&&(n=a),n>o&&(n=o))),this.displayBtn=void 0!==t||void 0!==n,this.setExtremes(t,n,!1,void 0,{trigger:"zoom"})),i.zoomed=!0}),r.zoomed},setAxisSize:function(){var i=this.chart,t=this.options,e=t.offsets||[0,0,0,0],s=this.horiz,n=this.width=Math.round(relativeLength(pick(t.width,i.plotWidth-e[3]+e[1]),i.plotWidth)),a=this.height=Math.round(relativeLength(pick(t.height,i.plotHeight-e[0]+e[2]),i.plotHeight)),o=this.top=Math.round(relativeLength(pick(t.top,i.plotTop+e[0]),i.plotHeight,i.plotTop)),r=this.left=Math.round(relativeLength(pick(t.left,i.plotLeft+e[3]),i.plotWidth,i.plotLeft));this.bottom=i.chartHeight-a-o,this.right=i.chartWidth-n-r,this.len=Math.max(s?n:a,0),this.pos=s?r:o},getExtremes:function(){var i=this.isLog;return{min:i?correctFloat(this.lin2log(this.min)):this.min,max:i?correctFloat(this.lin2log(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(i){var t=this.isLog,e=t?this.lin2log(this.min):this.min,s=t?this.lin2log(this.max):this.max;return null===i||i===-1/0?i=e:i===1/0?i=s:e>i?i=e:s<i&&(i=s),this.translate(i,0,1,0,1)},autoLabelAlign:function(i){var t=(pick(i,0)-90*this.side+720)%360,e={align:"center"};return fireEvent(this,"autoLabelAlign",e,function(i){t>15&&t<165?i.align="right":t>195&&t<345&&(i.align="left")}),e.align},tickSize:function(i){var t,e,s=this.options,n=s[i+"Length"],a=pick(s[i+"Width"],"tick"===i&&this.isXAxis&&!this.categories?1:0);return a&&n&&("inside"===s[i+"Position"]&&(n=-n),e=[n,a]),fireEvent(this,"afterTickSize",t={tickSize:e}),t.tickSize},labelMetrics:function(){var i=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style&&this.options.labels.style.fontSize,this.ticks[i]&&this.ticks[i].label)},unsquish:function(){var i,t,e,s=this.options.labels,n=this.horiz,a=this.tickInterval,o=a,r=this.len/(((this.categories?1:0)+this.max-this.min)/a),h=s.rotation,l=this.labelMetrics(),c=Number.MAX_VALUE,d=this.max-this.min,m=function(i){var t=i/(r||1);return(t=t>1?Math.ceil(t):1)*a>d&&i!==1/0&&r!==1/0&&d&&(t=Math.ceil(d/a)),correctFloat(t*a)};return n?(e=!s.staggerLines&&!s.step&&(defined(h)?[h]:r<pick(s.autoRotationLimit,80)&&s.autoRotation))&&e.forEach(function(e){var s;(e===h||e&&e>=-90&&e<=90)&&(s=(t=m(Math.abs(l.h/Math.sin(deg2rad*e))))+Math.abs(e/360))<c&&(c=s,i=e,o=t)}):s.step||(o=m(l.h)),this.autoRotation=e,this.labelRotation=pick(i,h),o},getSlotWidth:function(i){var t=this.chart,e=this.horiz,s=this.options.labels,n=Math.max(this.tickPositions.length-(this.categories?0:1),1),a=t.margin[3];return i&&i.slotWidth||e&&(s.step||0)<2&&!s.rotation&&(this.staggerLines||1)*this.len/n||!e&&(s.style&&parseInt(s.style.width,10)||a&&a-t.spacing[3]||.33*t.chartWidth)},renderUnsquish:function(){var i,t,e,s,n,a=this.chart,o=a.renderer,r=this.tickPositions,h=this.ticks,l=this.options.labels,c=l&&l.style||{},d=this.horiz,m=this.getSlotWidth(),f=Math.max(1,Math.round(m-2*(l.padding||5))),g={},u=this.labelMetrics(),x=l.style&&l.style.textOverflow,p=0;if(isString(l.rotation)||(g.rotation=l.rotation||0),r.forEach(function(i){(i=h[i]).movedLabel&&i.replaceMovedLabel(),i&&i.label&&i.label.textPxLength>p&&(p=i.label.textPxLength)}),this.maxLabelLength=p,this.autoRotation)p>f&&p>u.h?g.rotation=this.labelRotation:this.labelRotation=0;else if(m&&(i=f,!x))for(t="clip",s=r.length;!d&&s--;)n=r[s],(e=h[n].label)&&(e.styles&&"ellipsis"===e.styles.textOverflow?e.css({textOverflow:"clip"}):e.textPxLength>m&&e.css({width:m+"px"}),e.getBBox().height>this.len/r.length-(u.h-u.f)&&(e.specificTextOverflow="ellipsis"));g.rotation&&(i=p>.5*a.chartHeight?.33*a.chartHeight:p,x||(t="ellipsis")),this.labelAlign=l.align||this.autoLabelAlign(this.labelRotation),this.labelAlign&&(g.align=this.labelAlign),r.forEach(function(e){var s=h[e],n=s&&s.label,a=c.width,o={};n&&(n.attr(g),s.shortenLabel?s.shortenLabel():i&&!a&&"nowrap"!==c.whiteSpace&&(i<n.textPxLength||"SPAN"===n.element.tagName)?(o.width=i,x||(o.textOverflow=n.specificTextOverflow||t),n.css(o)):n.styles&&n.styles.width&&!o.width&&!a&&n.css({width:null}),delete n.specificTextOverflow,s.rotation=g.rotation)},this),this.tickRotCorr=o.rotCorr(u.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.series.some(function(i){return i.hasData()})||this.options.showEmpty&&defined(this.min)&&defined(this.max)},addTitle:function(i){var t,e=this.chart.renderer,s=this.horiz,n=this.opposite,a=this.options.title,o=this.chart.styledMode;this.axisTitle||((t=a.textAlign)||(t=(s?{low:"left",middle:"center",high:"right"}:{low:n?"right":"left",middle:"center",high:n?"left":"right"})[a.align]),this.axisTitle=e.text(a.text,0,0,a.useHTML).attr({zIndex:7,rotation:a.rotation||0,align:t}).addClass("highcharts-axis-title"),o||this.axisTitle.css(merge(a.style)),this.axisTitle.add(this.axisGroup),this.axisTitle.isNew=!0),o||a.style.width||this.isRadial||this.axisTitle.css({width:this.len}),this.axisTitle[i?"show":"hide"](i)},generateTick:function(i){var t=this.ticks;t[i]?t[i].addLabel():t[i]=new Tick(this,i)},getOffset:function(){var i,t,e,s,n,a,o,r=this,h=r.chart,l=h.renderer,c=r.options,d=r.tickPositions,m=r.ticks,f=r.horiz,g=r.side,u=h.inverted&&!r.isZAxis?[1,0,3,2][g]:g,x=0,p=0,k=c.title,v=c.labels,M=0,b=h.axisOffset,T=h.clipOffset,L=[-1,1,1,-1][g],P=c.className,A=r.axisParent;i=r.hasData(),r.showAxis=t=i||pick(c.showEmpty,!0),r.staggerLines=r.horiz&&v.staggerLines,r.axisGroup||(r.gridGroup=l.g("grid").attr({zIndex:c.gridZIndex||1}).addClass("highcharts-"+this.coll.toLowerCase()+"-grid "+(P||"")).add(A),r.axisGroup=l.g("axis").attr({zIndex:c.zIndex||2}).addClass("highcharts-"+this.coll.toLowerCase()+" "+(P||"")).add(A),r.labelGroup=l.g("axis-labels").attr({zIndex:v.zIndex||7}).addClass("highcharts-"+r.coll.toLowerCase()+"-labels "+(P||"")).add(A)),i||r.isLinked?(d.forEach(function(i,t){r.generateTick(i,t)}),r.renderUnsquish(),r.reserveSpaceDefault=0===g||2===g||{1:"left",3:"right"}[g]===r.labelAlign,pick(v.reserveSpace,"center"===r.labelAlign||null,r.reserveSpaceDefault)&&d.forEach(function(i){M=Math.max(m[i].getLabelSize(),M)}),r.staggerLines&&(M*=r.staggerLines),r.labelOffset=M*(r.opposite?-1:1)):objectEach(m,function(i,t){i.destroy(),delete m[t]}),k&&k.text&&!1!==k.enabled&&(r.addTitle(t),t&&!1!==k.reserveSpace&&(r.titleOffset=x=r.axisTitle.getBBox()[f?"height":"width"],e=k.offset,p=defined(e)?0:pick(k.margin,f?5:10))),r.renderLine(),r.offset=L*pick(c.offset,b[g]?b[g]+(c.margin||0):0),r.tickRotCorr=r.tickRotCorr||{x:0,y:0},a=0===g?-r.labelMetrics().h:2===g?r.tickRotCorr.y:0,s=Math.abs(M)+p,M&&(s-=a,s+=L*(f?pick(v.y,r.tickRotCorr.y+8*L):v.x)),r.axisTitleMargin=pick(e,s),r.getMaxLabelDimensions&&(r.maxLabelDimensions=r.getMaxLabelDimensions(m,d)),o=this.tickSize("tick"),b[g]=Math.max(b[g],r.axisTitleMargin+x+L*r.offset,s,d&&d.length&&o?o[0]+L*r.offset:0),n=c.offset?0:2*Math.floor(r.axisLine.strokeWidth()/2),T[u]=Math.max(T[u],n),fireEvent(this,"afterGetOffset")},getLinePath:function(i){var t=this.chart,e=this.opposite,s=this.offset,n=this.horiz,a=this.left+(e?this.width:0)+s,o=t.chartHeight-this.bottom-(e?this.height:0)+s;return e&&(i*=-1),t.renderer.crispLine(["M",n?this.left:a,n?o:this.top,"L",n?t.chartWidth-this.right:a,n?o:t.chartHeight-this.bottom],i)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.chart.styledMode||this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var i=this.horiz,t=this.left,e=this.top,s=this.len,n=this.options.title,a=i?t:e,o=this.opposite,r=this.offset,h=n.x||0,l=n.y||0,c=this.axisTitle,d=this.chart.renderer.fontMetrics(n.style&&n.style.fontSize,c),m=Math.max(c.getBBox(null,0).height-d.h-1,0),f={low:a+(i?0:s),middle:a+s/2,high:a+(i?s:0)}[n.align],g=(i?e+this.height:t)+(i?1:-1)*(o?-1:1)*this.axisTitleMargin+[-m,m,d.f,-m][this.side],u={x:i?f+h:g+(o?this.width:0)+r+h,y:i?g+l-(o?this.height:0)+r:f+l};return fireEvent(this,"afterGetTitlePosition",{titlePosition:u}),u},renderMinorTick:function(i){var t=this.chart.hasRendered&&isNumber(this.oldMin),e=this.minorTicks;e[i]||(e[i]=new Tick(this,i,"minor")),t&&e[i].isNew&&e[i].render(null,!0),e[i].render(null,!1,1)},renderTick:function(i,t){var e=this.isLinked,s=this.ticks,n=this.chart.hasRendered&&isNumber(this.oldMin);(!e||i>=this.min&&i<=this.max)&&(s[i]||(s[i]=new Tick(this,i)),n&&s[i].isNew&&s[i].render(t,!0,-1),s[i].render(t))},render:function(){var i,t,e=this,s=e.chart,n=s.renderer,a=e.options,o=e.isLog,r=e.isLinked,h=e.tickPositions,l=e.axisTitle,c=e.ticks,d=e.minorTicks,m=e.alternateBands,f=a.stackLabels,g=a.alternateGridColor,u=e.tickmarkOffset,x=e.axisLine,p=e.showAxis,k=animObject(n.globalAnimation);if(e.labelEdge.length=0,e.overlap=!1,[c,d,m].forEach(function(i){objectEach(i,function(i){i.isActive=!1})}),(e.hasData()||r)&&(e.minorTickInterval&&!e.categories&&e.getMinorTickPositions().forEach(function(i){e.renderMinorTick(i)}),h.length&&(h.forEach(function(i,t){e.renderTick(i,t)}),u&&(0===e.min||e.single)&&(c[-1]||(c[-1]=new Tick(e,-1,null,!0)),c[-1].render(-1))),g&&h.forEach(function(n,a){t=void 0!==h[a+1]?h[a+1]+u:e.max-u,a%2==0&&n<e.max&&t<=e.max+(s.polar?-u:u)&&(m[n]||(m[n]=new H.PlotLineOrBand(e)),i=n+u,m[n].options={from:o?e.lin2log(i):i,to:o?e.lin2log(t):t,color:g},m[n].render(),m[n].isActive=!0)}),e._addedPlotLB||((a.plotLines||[]).concat(a.plotBands||[]).forEach(function(i){e.addPlotBandOrLine(i)}),e._addedPlotLB=!0)),[c,d,m].forEach(function(i){var t,e=[],n=k.duration;objectEach(i,function(i,t){i.isActive||(i.render(t,!1,0),i.isActive=!1,e.push(t))}),syncTimeout(function(){for(t=e.length;t--;)i[e[t]]&&!i[e[t]].isActive&&(i[e[t]].destroy(),delete i[e[t]])},i!==m&&s.hasRendered&&n?n:0)}),x&&(x[x.isPlaced?"animate":"attr"]({d:this.getLinePath(x.strokeWidth())}),x.isPlaced=!0,x[p?"show":"hide"](p)),l&&p){var v=e.getTitlePosition();isNumber(v.y)?(l[l.isNew?"attr":"animate"](v),l.isNew=!1):(l.attr("y",-9999),l.isNew=!0)}f&&f.enabled&&e.renderStackTotals(),e.isDirty=!1,fireEvent(this,"afterRender")},redraw:function(){this.visible&&(this.render(),this.plotLinesAndBands.forEach(function(i){i.render()})),this.series.forEach(function(i){i.isDirty=!0})},keepProps:["extKey","hcEvents","names","series","userMax","userMin"],destroy:function(i){var t,e,s=this,n=s.stacks,a=s.plotLinesAndBands;if(fireEvent(this,"destroy",{keepEvents:i}),i||removeEvent(s),objectEach(n,function(i,t){destroyObjectProperties(i),n[t]=null}),[s.ticks,s.minorTicks,s.alternateBands].forEach(function(i){destroyObjectProperties(i)}),a)for(e=a.length;e--;)a[e].destroy();for(t in["stackTotalGroup","axisLine","axisTitle","axisGroup","gridGroup","labelGroup","cross","scrollbar"].forEach(function(i){s[i]&&(s[i]=s[i].destroy())}),s.plotLinesAndBandsGroups)s.plotLinesAndBandsGroups[t]=s.plotLinesAndBandsGroups[t].destroy();objectEach(s,function(i,t){-1===s.keepProps.indexOf(t)&&delete s[t]})},drawCrosshair:function(i,t){var e,s,n,a,o=this.crosshair,r=pick(o.snap,!0),h=this.cross,l=this.chart;if(fireEvent(this,"drawCrosshair",{e:i,point:t}),i||(i=this.cross&&this.cross.e),this.crosshair&&!1!==(defined(t)||!r)){if(r?defined(t)&&(s=pick("colorAxis"!==this.coll?t.crosshairPos:null,this.isXAxis?t.plotX:this.len-t.plotY)):s=i&&(this.horiz?i.chartX-this.pos:this.len-i.chartY+this.pos),defined(s)&&(a={value:t&&(this.isXAxis?t.x:pick(t.stackY,t.y)),translatedValue:s},l.polar&&extend(a,{isCrosshair:!0,chartX:i&&i.chartX,chartY:i&&i.chartY,point:t}),e=this.getPlotLinePath(a)||null),!defined(e))return void this.hideCrosshair();n=this.categories&&!this.isRadial,h||(this.cross=h=l.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(n?"category ":"thin ")+o.className).attr({zIndex:pick(o.zIndex,2)}).add(),l.styledMode||(h.attr({stroke:o.color||(n?color("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":pick(o.width,1)}).css({"pointer-events":"none"}),o.dashStyle&&h.attr({dashstyle:o.dashStyle}))),h.show().attr({d:e}),n&&!o.width&&h.attr({"stroke-width":this.transA}),this.cross.e=i}else this.hideCrosshair();fireEvent(this,"afterDrawCrosshair",{e:i,point:t})},hideCrosshair:function(){this.cross&&this.cross.hide(),fireEvent(this,"afterHideCrosshair")}}),H.Axis=Axis;export default Axis;