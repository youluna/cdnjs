"use strict";import Highcharts from"./Globals.js";import U from"./Utilities.js";var defined=U.defined,error=U.error,extend=U.extend,isObject=U.isObject,merge=U.merge,objectEach=U.objectEach,pad=U.pad,pick=U.pick,splat=U.splat,timeUnits=U.timeUnits,H=Highcharts,win=H.win,Time=function(){function e(e){this.options={},this.useUTC=!1,this.variableTimezone=!1,this.Date=win.Date,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.update(e)}return e.prototype.get=function(e,t){if(this.variableTimezone||this.timezoneOffset){var i=t.getTime(),n=i-this.getTimezoneOffset(t);t.setTime(n);var s=t["getUTC"+e]();return t.setTime(i),s}return this.useUTC?t["getUTC"+e]():t["get"+e]()},e.prototype.set=function(e,t,i){if(this.variableTimezone||this.timezoneOffset){if("Milliseconds"===e||"Seconds"===e||"Minutes"===e)return t["setUTC"+e](i);var n=this.getTimezoneOffset(t),s=t.getTime()-n;t.setTime(s),t["setUTC"+e](i);var o=this.getTimezoneOffset(t);return s=t.getTime()+o,t.setTime(s)}return this.useUTC?t["setUTC"+e](i):t["set"+e](i)},e.prototype.update=function(e){var t=pick(e&&e.useUTC,!0);this.options=e=merge(!0,this.options||{},e),this.Date=e.Date||win.Date||Date,this.useUTC=t,this.timezoneOffset=t&&e.timezoneOffset,this.getTimezoneOffset=this.timezoneOffsetFunction(),this.variableTimezone=!(t&&!e.getTimezoneOffset&&!e.timezone)},e.prototype.makeTime=function(e,t,i,n,s,o){var r,a,m;return this.useUTC?(r=this.Date.UTC.apply(0,arguments),r+=a=this.getTimezoneOffset(r),a!==(m=this.getTimezoneOffset(r))?r+=m-a:a-36e5!==this.getTimezoneOffset(r-36e5)||H.isSafari||(r-=36e5)):r=new this.Date(e,t,pick(i,1),pick(n,0),pick(s,0),pick(o,0)).getTime(),r},e.prototype.timezoneOffsetFunction=function(){var e=this,t=this.options,i=win.moment;if(!this.useUTC)return function(e){return 6e4*new Date(e.toString()).getTimezoneOffset()};if(t.timezone){if(i)return function(e){return 6e4*-i.tz(e,t.timezone).utcOffset()};error(25)}return this.useUTC&&t.getTimezoneOffset?function(e){return 6e4*t.getTimezoneOffset(e.valueOf())}:function(){return 6e4*(e.timezoneOffset||0)}},e.prototype.dateFormat=function(e,t,i){var n;if(!defined(t)||isNaN(t))return(null===(n=H.defaultOptions.lang)||void 0===n?void 0:n.invalidDate)||"";e=pick(e,"%Y-%m-%d %H:%M:%S");var s=this,o=new this.Date(t),r=this.get("Hours",o),a=this.get("Day",o),m=this.get("Date",o),f=this.get("Month",o),u=this.get("FullYear",o),h=H.defaultOptions.lang,p=null==h?void 0:h.weekdays,g=null==h?void 0:h.shortWeekdays,d=extend({a:g?g[a]:p[a].substr(0,3),A:p[a],d:pad(m),e:pad(m,2," "),w:a,b:h.shortMonths[f],B:h.months[f],m:pad(f+1),o:f+1,y:u.toString().substr(2,2),Y:u,H:pad(r),k:r,I:pad(r%12||12),l:r%12||12,M:pad(this.get("Minutes",o)),p:r<12?"AM":"PM",P:r<12?"am":"pm",S:pad(o.getSeconds()),L:pad(Math.floor(t%1e3),3)},H.dateFormats);return objectEach(d,function(i,n){for(;-1!==e.indexOf("%"+n);)e=e.replace("%"+n,"function"==typeof i?i.call(s,t):i)}),i?e.substr(0,1).toUpperCase()+e.substr(1):e},e.prototype.resolveDTLFormat=function(e){return isObject(e,!0)?e:{main:(e=splat(e))[0],from:e[1],to:e[2]}},e.prototype.getTimeTicks=function(e,t,i,n){var s,o,r,a,m=this,f=m.Date,u=[],h={},p=new f(t),g=e.unitRange,d=e.count||1;if(n=pick(n,1),defined(t)){m.set("Milliseconds",p,g>=timeUnits.second?0:d*Math.floor(m.get("Milliseconds",p)/d)),g>=timeUnits.second&&m.set("Seconds",p,g>=timeUnits.minute?0:d*Math.floor(m.get("Seconds",p)/d)),g>=timeUnits.minute&&m.set("Minutes",p,g>=timeUnits.hour?0:d*Math.floor(m.get("Minutes",p)/d)),g>=timeUnits.hour&&m.set("Hours",p,g>=timeUnits.day?0:d*Math.floor(m.get("Hours",p)/d)),g>=timeUnits.day&&m.set("Date",p,g>=timeUnits.month?1:Math.max(1,d*Math.floor(m.get("Date",p)/d))),g>=timeUnits.month&&(m.set("Month",p,g>=timeUnits.year?0:d*Math.floor(m.get("Month",p)/d)),o=m.get("FullYear",p)),g>=timeUnits.year&&(o-=o%d,m.set("FullYear",p,o)),g===timeUnits.week&&(a=m.get("Day",p),m.set("Date",p,m.get("Date",p)-a+n+(a<n?-7:0))),o=m.get("FullYear",p);var T=m.get("Month",p),c=m.get("Date",p),l=m.get("Hours",p);t=p.getTime(),m.variableTimezone&&(r=i-t>4*timeUnits.month||m.getTimezoneOffset(t)!==m.getTimezoneOffset(i));var U=p.getTime();for(s=1;U<i;)u.push(U),g===timeUnits.year?U=m.makeTime(o+s*d,0):g===timeUnits.month?U=m.makeTime(o,T+s*d):!r||g!==timeUnits.day&&g!==timeUnits.week?r&&g===timeUnits.hour&&d>1?U=m.makeTime(o,T,c,l+s*d):U+=g*d:U=m.makeTime(o,T,c+s*d*(g===timeUnits.day?1:7)),s++;u.push(U),g<=timeUnits.hour&&u.length<1e4&&u.forEach(function(e){e%18e5==0&&"000000000"===m.dateFormat("%H%M%S%L",e)&&(h[e]="day")})}return u.info=extend(e,{higherRanks:h,totalRange:g*d}),u},e.defaultOptions={Date:void 0,getTimezoneOffset:void 0,timezone:void 0,timezoneOffset:0,useUTC:!0},e}();H.Time=Time;export default H.Time;