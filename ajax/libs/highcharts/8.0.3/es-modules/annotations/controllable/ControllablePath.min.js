"use strict";import H from"./../../parts/Globals.js";import U from"./../../parts/Utilities.js";var extend=U.extend,merge=U.merge;import controllableMixin from"./controllableMixin.js";import markerMixin from"./markerMixin.js";var TRACKER_FILL="rgba(192,192,192,"+(H.svg?1e-4:.002)+")",ControllablePath=function(t,r,e){this.init(t,r,e),this.collection="shapes"};ControllablePath.attrsMap={dashStyle:"dashstyle",strokeWidth:"stroke-width",stroke:"stroke",fill:"fill",zIndex:"zIndex"},merge(!0,ControllablePath.prototype,controllableMixin,{type:"path",setMarkers:markerMixin.setItemMarkers,toD:function(){var t=this.options.d;if(t)return"function"==typeof t?t.call(this):t;var r,e=this.points,i=e.length,a=i,s=e[0],o=a&&this.anchor(s).absolutePosition,n=0,l=2;for(t=o&&["M",o.x,o.y];++n<i&&a;)r=(s=e[n]).command||"L",o=this.anchor(s).absolutePosition,"Z"===r?t[++l]=r:(r!==e[n-1].command&&(t[++l]=r),t[++l]=o.x,t[++l]=o.y),a=s.series.visible;return a?this.chart.renderer.crispLine(t,this.graphic.strokeWidth()):null},shouldBeDrawn:function(){return controllableMixin.shouldBeDrawn.call(this)||Boolean(this.options.d)},render:function(t){var r=this.options,e=this.attrsFromOptions(r);this.graphic=this.annotation.chart.renderer.path(["M",0,0]).attr(e).add(t),r.className&&this.graphic.addClass(r.className),this.tracker=this.annotation.chart.renderer.path(["M",0,0]).addClass("highcharts-tracker-line").attr({zIndex:2}).add(t),this.annotation.chart.styledMode||this.tracker.attr({"stroke-linejoin":"round",stroke:TRACKER_FILL,fill:TRACKER_FILL,"stroke-width":this.graphic.strokeWidth()+2*r.snap}),controllableMixin.render.call(this),extend(this.graphic,{markerStartSetter:markerMixin.markerStartSetter,markerEndSetter:markerMixin.markerEndSetter}),this.setMarkers(this)},redraw:function(t){var r=this.toD(),e=t?"animate":"attr";r?(this.graphic[e]({d:r}),this.tracker[e]({d:r})):(this.graphic.attr({d:"M 0 "+-9e9}),this.tracker.attr({d:"M 0 "+-9e9})),this.graphic.placed=this.tracker.placed=Boolean(r),controllableMixin.redraw.call(this,t)}});export default ControllablePath;