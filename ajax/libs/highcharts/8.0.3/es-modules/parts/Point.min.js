"use strict";import Highcharts from"./Globals.js";import U from"./Utilities.js";var animObject=U.animObject,defined=U.defined,erase=U.erase,extend=U.extend,format=U.format,getNestedProperty=U.getNestedProperty,isArray=U.isArray,isNumber=U.isNumber,isObject=U.isObject,syncTimeout=U.syncTimeout,pick=U.pick,removeEvent=U.removeEvent,uniqueKey=U.uniqueKey,H=Highcharts,fireEvent=H.fireEvent,Point=function(){function t(){this.category=void 0,this.colorIndex=void 0,this.formatPrefix="point",this.id=void 0,this.isNull=!1,this.name=void 0,this.options=void 0,this.percentage=void 0,this.selected=!1,this.series=void 0,this.total=void 0,this.visible=!0,this.x=void 0}return t.prototype.animateBeforeDestroy=function(){var t,e=this,o={x:e.startXPos,opacity:0},i=e.getGraphicalProps();i.singular.forEach(function(i){t="dataLabel"===i,e[i]=e[i].animate(t?{x:e[i].startXPos,y:e[i].startYPos,opacity:0}:o)}),i.plural.forEach(function(t){e[t].forEach(function(t){t.element&&t.animate(extend({x:e.startXPos},t.startYPos?{x:t.startXPos,y:t.startYPos}:{}))})})},t.prototype.applyOptions=function(e,o){var i=this.series,s=i.options.pointValKey||i.pointValKey;return e=t.prototype.optionsToObject.call(this,e),extend(this,e),this.options=this.options?extend(this.options,e):e,e.group&&delete this.group,e.dataLabels&&delete this.dataLabels,s&&(this.y=t.prototype.getNestedProperty.call(this,s)),this.isNull=pick(this.isValid&&!this.isValid(),null===this.x||!isNumber(this.y)),this.formatPrefix=this.isNull?"null":"point",this.selected&&(this.state="select"),"name"in this&&void 0===o&&i.xAxis&&i.xAxis.hasNames&&(this.x=i.xAxis.nameToX(this)),void 0===this.x&&i&&(this.x=void 0===o?i.autoIncrement(this):o),this},t.prototype.destroy=function(){var t,e=this,o=e.series,i=o.chart,s=o.options.dataSorting,r=i.hoverPoints,n=e.series.chart.renderer.globalAnimation,a=animObject(n);function h(){for(t in(e.graphic||e.dataLabel||e.dataLabels)&&(removeEvent(e),e.destroyElements()),e)e[t]=null}e.legendItem&&i.legend.destroyItem(e),r&&(e.setState(),erase(r,e),r.length||(i.hoverPoints=null)),e===i.hoverPoint&&e.onMouseOut(),s&&s.enabled?(this.animateBeforeDestroy(),syncTimeout(h,a.duration)):h(),i.pointCount--},t.prototype.destroyElements=function(t){var e=this,o=e.getGraphicalProps(t);o.singular.forEach(function(t){e[t]=e[t].destroy()}),o.plural.forEach(function(t){e[t].forEach(function(t){t.element&&t.destroy()}),delete e[t]})},t.prototype.firePointEvent=function(t,e,o){var i=this,s=this.series.options;(s.point.events[t]||i.options&&i.options.events&&i.options.events[t])&&i.importEvents(),"click"===t&&s.allowPointSelect&&(o=function(t){i.select&&i.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),fireEvent(i,t,e,o)},t.prototype.getClassName=function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},t.prototype.getGraphicalProps=function(t){var e,o,i=this,s=[],r={singular:[],plural:[]};for((t=t||{graphic:1,dataLabel:1}).graphic&&s.push("graphic","shadowGroup"),t.dataLabel&&s.push("dataLabel","dataLabelUpper","connector"),o=s.length;o--;)e=s[o],i[e]&&r.singular.push(e);return["dataLabel","connector"].forEach(function(e){var o=e+"s";t[e]&&i[o]&&r.plural.push(o)}),r},t.prototype.getLabelConfig=function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},t.prototype.getNestedProperty=function(t){if(t)return 0===t.indexOf("custom.")?getNestedProperty(t,this.options):this[t]},t.prototype.getZone=function(){var t,e=this.series,o=e.zones,i=e.zoneAxis||"y",s=0;for(t=o[s];this[i]>=t.value;)t=o[++s];return this.nonZonedColor||(this.nonZonedColor=this.color),t&&t.color&&!this.options.color?this.color=t.color:this.color=this.nonZonedColor,t},t.prototype.hasNewShapeType=function(){return(this.graphic&&(this.graphic.symbolName||this.graphic.element.nodeName))!==this.shapeType},t.prototype.init=function(t,e,o){return this.series=t,this.applyOptions(e,o),this.id=defined(this.id)?this.id:uniqueKey(),this.resolveColor(),t.chart.pointCount++,fireEvent(this,"afterInit"),this},t.prototype.optionsToObject=function(e){var o,i={},s=this.series,r=s.options.keys,n=r||s.pointArrayMap||["y"],a=n.length,h=0,l=0;if(isNumber(e)||null===e)i[n[0]]=e;else if(isArray(e))for(!r&&e.length>a&&("string"===(o=typeof e[0])?i.name=e[0]:"number"===o&&(i.x=e[0]),h++);l<a;)r&&void 0===e[h]||(n[l].indexOf(".")>0?t.prototype.setNestedProperty(i,e[h],n[l]):i[n[l]]=e[h]),h++,l++;else"object"==typeof e&&(i=e,e.dataLabels&&(s._hasPointLabels=!0),e.marker&&(s._hasPointMarkers=!0));return i},t.prototype.resolveColor=function(){var t,e,o=this.series,i=o.chart.options.chart.colorCount,s=o.chart.styledMode;s||this.options.color||(this.color=o.color),o.options.colorByPoint?(s||(t=o.options.colors||o.chart.options.colors,this.color=this.color||t[o.colorCounter],i=t.length),e=o.colorCounter,o.colorCounter++,o.colorCounter===i&&(o.colorCounter=0)):e=o.colorIndex,this.colorIndex=pick(this.colorIndex,e)},t.prototype.setNestedProperty=function(t,e,o){return o.split(".").reduce(function(t,o,i,s){var r=s.length-1===i;return t[o]=r?e:isObject(t[o],!0)?t[o]:{},t[o]},t),t},t.prototype.tooltipFormatter=function(t){var e=this.series,o=e.tooltipOptions,i=pick(o.valueDecimals,""),s=o.valuePrefix||"",r=o.valueSuffix||"";return e.chart.styledMode&&(t=e.chart.tooltip.styledModeFormat(t)),(e.pointArrayMap||["y"]).forEach(function(e){e="{point."+e,(s||r)&&(t=t.replace(RegExp(e+"}","g"),s+e+"}"+r)),t=t.replace(RegExp(e+"}","g"),e+":,."+i+"f}")}),format(t,{point:this,series:this.series},e.chart)},t}();H.Point=Point;export default H.Point;