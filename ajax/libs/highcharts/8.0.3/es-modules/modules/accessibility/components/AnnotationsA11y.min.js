"use strict";import U from"../../../parts/Utilities.js";var inArray=U.inArray;import HTMLUtilities from"../utils/htmlUtilities.js";var escapeStringForHTML=HTMLUtilities.escapeStringForHTML,stripHTMLTagsFromString=HTMLUtilities.stripHTMLTagsFromString;function getChartAnnotationLabels(t){return(t.annotations||[]).reduce(function(t,n){var i;return!1!==(null===(i=n.options)||void 0===i?void 0:i.visible)&&(t=t.concat(n.labels)),t},[])}function getLabelText(t){var n,i,o,e,r=null===(i=null===(n=t.options)||void 0===n?void 0:n.accessibility)||void 0===i?void 0:i.description;return r||((null===(e=null===(o=t.graphic)||void 0===o?void 0:o.text)||void 0===e?void 0:e.textStr)||"")}function getAnnotationLabelDescription(t){var n,i,o=null===(i=null===(n=t.options)||void 0===n?void 0:n.accessibility)||void 0===i?void 0:i.description;if(o)return o;var e=t.chart,r=getLabelText(t),a=t.points,s=a.filter(function(t){return!!t.graphic}).map(function(t){var n,i=(null===(n=null==t?void 0:t.accessibility)||void 0===n?void 0:n.valueDescription)||function(t){var n,i;return(null===(i=null===(n=null==t?void 0:t.graphic)||void 0===n?void 0:n.element)||void 0===i?void 0:i.getAttribute("aria-label"))||""}(t),o=(null==t?void 0:t.series.name)||"";return(o?o+", ":"")+"data point "+i}).filter(function(t){return!!t}),l=s.length,u="accessibility.screenReaderSection.annotations.description"+(l>1?"MultiplePoints":l?"SinglePoint":"NoPoints"),c={annotationText:r,numPoints:l,annotationPoint:s[0],additionalAnnotationPoints:s.slice(1)};return e.langFormat(u,c)}function getAnnotationListItems(t){return getChartAnnotationLabels(t).map(function(t){var n=escapeStringForHTML(stripHTMLTagsFromString(getAnnotationLabelDescription(t)));return n?"<li>"+n+"</li>":""})}function getAnnotationsInfoHTML(t){var n=t.annotations;return n&&n.length?"<ul>"+getAnnotationListItems(t).join(" ")+"</ul>":""}function getPointAnnotationTexts(t){var n=getChartAnnotationLabels(t.series.chart).filter(function(n){return inArray(t,n.points)>-1});return n.length?n.map(function(t){return""+getLabelText(t)}):[]}var AnnotationsA11y={getAnnotationsInfoHTML:getAnnotationsInfoHTML,getAnnotationLabelDescription:getAnnotationLabelDescription,getAnnotationListItems:getAnnotationListItems,getPointAnnotationTexts:getPointAnnotationTexts};export default AnnotationsA11y;