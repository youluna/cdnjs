!function(k){k.extend(!0,window,{Slick:{Plugins:{RowDetailView:function(e){var u,c,p,w,n=null,o=this,t=null,d=[],i=new Slick.EventHandler,l=5,a=0,s={columnId:"_detail_selector",cssClass:"detailView-toggle",expandedClass:null,collapsedClass:null,keyPrefix:"_",loadOnce:!1,collapseAllOnSort:!0,saveDetailViewOnScroll:!0,singleRowExpand:!1,useSimpleViewportCalc:!1,alwaysRenderColumn:!0,toolTip:"",width:30,maxRows:null},g=s.keyPrefix,r=0,f=[],m=k.extend(!0,{},s,e);"function"==typeof m.expandableOverride&&E(m.expandableOverride);function R(e,i){if(e)for(var t=0;t<e.length;t++)if(e[t]===i)return t;return-1}function v(e,i){var t=u.getDataItem(i.row);if(z(i.row,t,u)&&(m.useRowClick||u.getColumns()[i.cell].id===m.columnId&&k(e.target).hasClass(m.cssClass))){if(u.getEditorLock().isActive()&&!u.getEditorLock().commitCurrentEdit())return e.preventDefault(),void e.stopImmediatePropagation();var n=w.getItem(i.row);o.onBeforeRowDetailToggle.notify({grid:u,item:n},e,o),function(e,i){if(!z(e,i,u))return;w.beginUpdate(),function(e){e&&(e[g+"collapsed"]?C(e):V(e))}(i),w.endUpdate()}(i.row,n),o.onAfterRowDetailToggle.notify({grid:u,item:n,expandedRows:d},e,o),e.stopPropagation(),e.stopImmediatePropagation()}}function h(e,i){m.useSimpleViewportCalc?function(){if(u){var t=u.getRenderedRange();d.forEach(function(e){var i=function(e,i){if(Math.abs(i.bottom-r-e)>2*a)return!0;return!1}(w.getRowById(e.id),t);!i&&0<=R(f,e.id)?x(e,e.id):i&&b(e,e.id)})}}():function(){if(u){var o=u.getRenderedRange();if(0<d.length){var a="DOWN";if(t){if(t.top===o.top&&t.bottom===o.bottom)return;(t.top>o.top||0===t.top&&0===o.top&&t.bottom>o.bottom)&&(a="UP")}}d.forEach(function(e){var i=w.getRowById(e.id),t=e[g+"sizePadding"],n=0<=R(f,e.id);"UP"===a?(m.saveDetailViewOnScroll&&i>=o.bottom-r&&I(e),n&&i-l<o.top&&i>=o.top?x(e,e.id):!n&&i+t>o.bottom&&b(e,e.id)):"DOWN"===a&&(m.saveDetailViewOnScroll&&i<=o.top+r&&I(e),n&&i+t+l>o.bottom&&i<i+t?x(e,e.id):!n&&i<o.top&&b(e,e.id))}),t=o}}()}function b(e,i){var t=e.rowIndex||w.getRowById(e.id);o.onRowOutOfViewportRange.notify({grid:u,item:e,rowId:i,rowIndex:t,expandedRows:d,rowIdsOutOfViewport:y(i,!0)},null,o)}function x(e,i){var t=e.rowIndex||w.getRowById(e.id);setTimeout(function(){k(".cellDetailView_"+e.id).length&&o.onRowBackToViewportRange.notify({grid:u,item:e,rowId:i,rowIndex:t,expandedRows:d,rowIdsOutOfViewport:y(i,!1)},null,o)},100)}function y(e,i){var t=R(f,e);return i&&t<0?f.push(e):!i&&0<=t&&f.splice(t,1),f}function D(){w.beginUpdate();for(var e=d.length-1;0<=e;e--)V(d[e],!0);w.endUpdate()}function V(i,e){e||w.beginUpdate(),m.loadOnce&&I(i),i[g+"collapsed"]=!0;for(var t=1;t<=i[g+"sizePadding"];t++)w.deleteItem(i.id+"."+t);i[g+"sizePadding"]=0,w.updateItem(i.id,i),d=d.filter(function(e){return e.id!==i.id}),e||w.endUpdate()}function C(e){if(m&&m.singleRowExpand&&D(),e[g+"collapsed"]=!1,d.push(e),e[g+"detailContent"]||(e[g+"detailViewLoaded"]=!1),e[g+"detailViewLoaded"]&&!0===m.loadOnce)return o.onAsyncResponse.notify({item:e,itemDetail:e,detailView:e[g+"detailContent"]},void 0,this),O(e),void w.updateItem(e.id,e);e[g+"detailContent"]=m.preTemplate(e),O(e),w.updateItem(e.id,e),m.process(e)}function I(e){if(k("."+p+" .innerDetailView_"+e.id)){var i=k("."+p+" .innerDetailView_"+e.id).html();void 0!==i&&(e[g+"detailContent"]=i)}}var P=function(e,i){var t={};for(var n in u.getData())t[n]=null;return t.id=e.id+"."+i,t[g+"collapsed"]=!0,t[g+"isPadding"]=!0,t[g+"parent"]=e,t[g+"offset"]=i,t};function O(e){var i=m.panelRows;e[g+"sizePadding"]=Math.ceil(2*i*13/c.rowHeight),e[g+"height"]=e[g+"sizePadding"]*c.rowHeight;for(var t=w.getIdxById(e.id),n=1;n<=e[g+"sizePadding"];n++)w.insertItem(t+n,P(e,n))}function S(e,i,t,n,o,a){if(!z(e,o,a))return null;if(null==o[g+"collapsed"]&&(o[g+"collapsed"]=!0,o[g+"sizePadding"]=0,o[g+"height"]=0,o[g+"isPadding"]=!1,o[g+"parent"]=void 0,o[g+"offset"]=0),o[g+"isPadding"])return null;if(o[g+"collapsed"]){var d=m.cssClass+" expand ";return m.collapsedClass&&(d+=m.collapsedClass),'<div class="'+d+'"></div>'}var l=[],s=c.rowHeight,r=o[g+"sizePadding"]*c.rowHeight;null!==m.maxRows&&o[g+"sizePadding"]>m.maxRows&&(r=m.maxRows*s,o[g+"sizePadding"]=m.maxRows);var u=m.cssClass+" collapse ";return m.expandedClass&&(u+=m.expandedClass),l.push('<div class="'+u+'"></div></div>'),l.push('<div class="dynamic-cell-detail cellDetailView_',o.id,'" '),l.push('style="height:',r,"px;"),l.push("top:",s,'px">'),l.push('<div class="detail-container detailViewContainer_',o.id,'">'),l.push('<div class="innerDetailView_',o.id,'">',o[g+"detailContent"],"</div></div>"),l.join("")}function z(e,i,t){return"function"!=typeof n||n(e,i,t)}function E(e){n=e}k.extend(this,{init:function(e){if(!e)throw new Error('RowDetailView Plugin requires the Grid instance to be passed as argument to the "init()" method');p=(u=e).getUID(),c=e.getOptions()||{},w=u.getData(),g=m&&m.keyPrefix||"_",r=u.getOptions().minRowBuffer,u.getOptions().minRowBuffer=m.panelRows+3,i.subscribe(u.onClick,v).subscribe(u.onScroll,h),m.collapseAllOnSort&&(i.subscribe(u.onSort,D),d=[],f=[]),i.subscribe(u.getData().onRowCountChanged,function(){u.updateRowCount(),u.render()}),i.subscribe(u.getData().onRowsChanged,function(e,i){u.invalidateRows(i.rows),u.render()}),o.onAsyncResponse.subscribe(function(e,i){if(!i||!i.item&&!i.itemDetail)throw'Slick.RowDetailView plugin requires the onAsyncResponse() to supply "args.item" property.';var t=i.item||i.itemDetail;i.detailView?t[g+"detailContent"]=i.detailView:t[g+"detailContent"]=m.postTemplate(t),t[g+"detailViewLoaded"]=!0,w.updateItem(t.id,t),o.onAsyncEndUpdate.notify({grid:u,item:t,itemDetail:t},e,o)}),m.useSimpleViewportCalc&&i.subscribe(u.onRendered,function(e,i){i&&i.endRow&&(a=i.endRow-i.startRow)})},destroy:function(){i.unsubscribeAll(),o.onAsyncResponse.unsubscribe(),o.onAsyncEndUpdate.unsubscribe(),o.onAfterRowDetailToggle.unsubscribe(),o.onBeforeRowDetailToggle.unsubscribe(),o.onRowOutOfViewportRange.unsubscribe(),o.onRowBackToViewportRange.unsubscribe()},pluginName:"RowDetailView",collapseAll:D,collapseDetailView:V,expandDetailView:C,expandableOverride:E,getColumnDefinition:function(){return{id:m.columnId,name:"",toolTip:m.toolTip,field:"sel",width:m.width,resizable:!1,sortable:!1,alwaysRenderColumn:m.alwaysRenderColumn,cssClass:m.cssClass,formatter:S}},getExpandedRows:function(){return d},getFilterItem:function(e){return e[g+"isPadding"]&&e[g+"parent"]&&(e=e[g+"parent"]),e},getOptions:function(){return m},resizeDetailView:function(e){if(e){var i=document.querySelector("."+p+" .detailViewContainer_"+e.id),t=document.querySelector("."+p+" .cellDetailView_"+e.id),n=document.querySelector("."+p+" .innerDetailView_"+e.id);if(i&&t&&n){for(var o=1;o<=e[g+"sizePadding"];o++)w.deleteItem(e.id+"."+o);var a=c.rowHeight;i.style.minHeight=null;var d=i.scrollHeight,l=Math.ceil(d/a);e[g+"sizePadding"]=Math.ceil(2*l*13/a),e[g+"height"]=d;var s=e[g+"sizePadding"]*a;null!==m.maxRows&&e[g+"sizePadding"]>m.maxRows&&(s=m.maxRows*a,e[g+"sizePadding"]=m.maxRows),u.getOptions().minRowBuffer<e[g+"sizePadding"]&&(u.getOptions().minRowBuffer=e[g+"sizePadding"]+3),i.setAttribute("style","min-height: "+e[g+"height"]+"px"),t&&t.setAttribute("style","height: "+s+"px; top:"+a+"px");var r=w.getIdxById(e.id);for(o=1;o<=e[g+"sizePadding"];o++)w.insertItem(r+o,P(e,o));I(e)}}},saveDetailView:I,setOptions:function(e){(m=k.extend(!0,{},m,e))&&m.singleRowExpand&&D()},onAsyncResponse:new Slick.Event,onAsyncEndUpdate:new Slick.Event,onAfterRowDetailToggle:new Slick.Event,onBeforeRowDetailToggle:new Slick.Event,onRowOutOfViewportRange:new Slick.Event,onRowBackToViewportRange:new Slick.Event})}}}})}(jQuery);