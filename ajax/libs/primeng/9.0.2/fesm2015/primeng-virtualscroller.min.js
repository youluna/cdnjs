import{EventEmitter,ElementRef,Input,ContentChild,ContentChildren,ViewChild,Output,Component,NgModule}from"@angular/core";import{CommonModule}from"@angular/common";import{Header,Footer,PrimeTemplate,SharedModule}from"primeng/api";import{ScrollingModule}from"@angular/cdk/scrolling";var __decorate=this&&this.__decorate||function(e,t,r,l){var o,i=arguments.length,a=i<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,r):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,l);else for(var n=e.length-1;n>=0;n--)(o=e[n])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a};let VirtualScroller=class{constructor(e){this.el=e,this.cache=!0,this.first=0,this.trackBy=((e,t)=>t),this.onLazyLoad=new EventEmitter,this._totalRecords=0,this.lazyValue=[],this.page=0}get totalRecords(){return this._totalRecords}set totalRecords(e){this._totalRecords=e,this.lazyValue=Array.from({length:this._totalRecords}),this.onLazyLoad.emit(this.createLazyLoadMetadata()),this.first=0,this.scrollTo(0)}get value(){return this.lazy?this.lazyValue:this._value}set value(e){if(this.lazy){if(e){let t=this.cache?[...this.lazyValue]:Array.from({length:this._totalRecords});for(let r=this.first,l=0;r<this.first+this.rows;r++,l++)t[r]=e[l];this.lazyValue=t}}else this._value=e}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this.itemTemplate=e.template;break;case"loadingItem":this.loadingItemTemplate=e.template;break;default:this.itemTemplate=e.template}})}onScrollIndexChange(e){let t=Math.floor(e/this.rows);t!==this.page&&(this.page=t,this.first=this.page*this.rows,this.onLazyLoad.emit(this.createLazyLoadMetadata()))}createLazyLoadMetadata(){return{first:this.first,rows:this.rows}}getBlockableElement(){return this.el.nativeElement.children[0]}scrollTo(e){this.viewPortViewChild&&this.viewPortViewChild.elementRef&&this.viewPortViewChild.elementRef.nativeElement&&(this.viewPortViewChild.elementRef.nativeElement.scrollTop=e*this.itemSize)}};VirtualScroller.ctorParameters=(()=>[{type:ElementRef}]),__decorate([Input()],VirtualScroller.prototype,"itemSize",void 0),__decorate([Input()],VirtualScroller.prototype,"style",void 0),__decorate([Input()],VirtualScroller.prototype,"styleClass",void 0),__decorate([Input()],VirtualScroller.prototype,"scrollHeight",void 0),__decorate([Input()],VirtualScroller.prototype,"lazy",void 0),__decorate([Input()],VirtualScroller.prototype,"cache",void 0),__decorate([Input()],VirtualScroller.prototype,"rows",void 0),__decorate([Input()],VirtualScroller.prototype,"first",void 0),__decorate([Input()],VirtualScroller.prototype,"trackBy",void 0),__decorate([ContentChild(Header,{static:!0})],VirtualScroller.prototype,"header",void 0),__decorate([ContentChild(Footer,{static:!0})],VirtualScroller.prototype,"footer",void 0),__decorate([ContentChildren(PrimeTemplate)],VirtualScroller.prototype,"templates",void 0),__decorate([ViewChild("viewport",{static:!0})],VirtualScroller.prototype,"viewPortViewChild",void 0),__decorate([Output()],VirtualScroller.prototype,"onLazyLoad",void 0),__decorate([Input()],VirtualScroller.prototype,"totalRecords",null),__decorate([Input()],VirtualScroller.prototype,"value",null);let VirtualScrollerModule=class{};VirtualScrollerModule=__decorate([NgModule({imports:[CommonModule,ScrollingModule],exports:[VirtualScroller=__decorate([Component({selector:"p-virtualScroller",template:'\n        <div [ngClass]="\'ui-virtualscroller ui-widget\'" [ngStyle]="style" [class]="styleClass">\n            <div class="ui-virtualscroller-header ui-widget-header ui-corner-top" *ngIf="header">\n                <ng-content select="p-header"></ng-content>\n            </div>\n            <div #content class="ui-virtualscroller-content ui-widget-content">\n                <ul class="ui-virtualscroller-list">\n                    <cdk-virtual-scroll-viewport #viewport [ngStyle]="{\'height\': scrollHeight}" [itemSize]="itemSize" (scrolledIndexChange)="onScrollIndexChange($event)">\n                        <ng-container *cdkVirtualFor="let item of value; trackBy: trackBy; let i = index; let c = count; let f = first; let l = last; let e = even; let o = odd; ">\n                            <li [ngStyle]="{\'height\': itemSize + \'px\'}">\n                                <ng-container *ngTemplateOutlet="item ? itemTemplate : loadingItemTemplate; context: {$implicit: item, index: i, count: c, first: f, last: l, even: e, odd: o}"></ng-container>\n                            </li>\n                        </ng-container>\n                    </cdk-virtual-scroll-viewport>\n                </ul>\n            </div>\n            <div class="ui-virtualscroller-footer ui-widget-header ui-corner-bottom" *ngIf="footer">\n                <ng-content select="p-footer"></ng-content>\n            </div>\n        </div>\n    '})],VirtualScroller),SharedModule,ScrollingModule],declarations:[VirtualScroller]})],VirtualScrollerModule);export{VirtualScroller,VirtualScrollerModule};